# V13.7 注册表清理与分析报告

**版本**: V13.7.0  
**审计日期**: 2025-01-XX  
**目标**: 清理未使用的模型、算法和规则，确保注册表与实际代码一致

---

## 📋 执行摘要

本次审计的目标是：
1. 识别所有实际使用的引擎、算法和模型
2. 比对注册表中的规则和算法
3. 找出未使用的注册项
4. 清理并重新整理，确保溯源信息完整

---

## 🔍 实际使用的引擎分析

### V13.7 新引擎（已实现）

| 引擎文件 | 类名 | 模块 | 状态 |
| --- | --- | --- | --- |
| `wealth_fluid_v13_7.py` | `WealthFluidEngineV13_7` | MOD_05 | ✅ 已使用 |
| `relationship_gravity_v13_7.py` | `RelationshipGravityEngineV13_7` | MOD_06 | ✅ 已使用 |
| `super_structure_resonance_v13_7.py` | `SuperStructureResonanceEngineV13_7` | MOD_02 | ✅ 已使用 |
| `stellar_coherence_v13_7.py` | `StellarCoherenceEngineV13_7` | MOD_17 | ✅ 已使用 |
| `temporal_prediction_v13_7.py` | `TemporalPredictionEngineV13_7` | MOD_16 | ✅ 已使用 |
| `pillar_gravity_v13_7.py` | `PillarGravityEngineV13_7` | MOD_11 | ✅ 已使用 |
| `spacetime_inertia_v13_7.py` | `SpacetimeInertiaEngineV13_7` | MOD_12 | ✅ 已使用 |
| `lifepath_resampling_v13_7.py` | `LifepathResamplingEngineV13_7` | MOD_07 | ✅ 已使用 |
| `global_interference_v13_7.py` | `GlobalInterferenceEngineV13_7` | MOD_18 | ✅ 已使用 |

### 旧引擎（可能已废弃）

| 引擎文件 | 状态 | 备注 |
| --- | --- | --- |
| `wealth_fluid.py` | ⚠️ 可能废弃 | 已被 `wealth_fluid_v13_7.py` 替代 |
| `relationship_gravity.py` | ⚠️ 可能废弃 | 已被 `relationship_gravity_v13_7.py` 替代 |
| `temporal_shunting.py` | ⚠️ 可能废弃 | 已被 `temporal_prediction_v13_7.py` 替代 |
| `structural_vibration.py` | ⚠️ 部分使用 | 被 `impedance_model.py` 引用，但功能已整合 |

### 其他引擎（仍在使用）

| 引擎文件 | 类名 | 状态 |
| --- | --- | --- |
| `quantum_dispersion.py` | `QuantumDispersionEngine` | ✅ 仍在使用 |
| `resonance_field.py` | `ResonanceFieldEngine` | ✅ 仍在使用 |
| `causal_entanglement.py` | `CausalEntanglementEngine` | ✅ 仍在使用 |
| `energy_flux.py` | `EnergyFluxEngine` | ✅ 仍在使用 |
| `structural_stress.py` | `StructuralStressEngine` | ✅ 仍在使用 |
| `unified_dynamics.py` | `UnifiedDynamicsEngine` | ✅ 仍在使用 |

---

## 🔗 核心算法和模型分析

### 已注册且实际使用的算法

#### MOD_05 财富流体
- ✅ `PH_WEALTH_PERMEABILITY` - 已使用（`WealthFluidEngineV13_7.calculate_reynolds_with_luck`）
- ✅ `PH_WEALTH_VISCOSITY` - 已使用（`WealthFluidEngineV13_7.calculate_viscosity_with_luck`）
- ✅ `PH_WEALTH_VISCOSITY_LUCK` - 已使用（新注册）
- ✅ `PH_WEALTH_PERMEABILITY_EFFICIENCY` - 已使用（新注册）
- ✅ `PH_BI_JIE_SHIELD` - 已使用（整合到粘滞系数计算）

#### MOD_06 情感引力
- ✅ `PH_GRAVITY_BINDING` - 已使用（`RelationshipGravityEngineV13_7.calculate_binding_energy`）
- ✅ `PH_ORBITAL_PERTURBATION` - 已使用（新注册）
- ✅ `PH_PERTURBATION_3BODY` - 已注册但可能未完全实现

#### MOD_02 极高位格局
- ✅ `PH_COHERENT_STATE_DETECTION` - 已使用（新注册）
- ✅ `PH17-20_CONG` - 已使用
- ✅ `PH19_BEATING` - 已使用
- ✅ `PH28_ANNIHILATION` - 已使用

#### MOD_15 结构传导
- ✅ `PH_COMPLEX_IMPEDANCE` - 已使用（`ComplexImpedanceModel.calculate_impedance`）
- ✅ `PH_NONLINEAR_SATURATION` - 已使用（整合到 `ComplexImpedanceModel`）
- ✅ `PH_VERTICAL_COUPLING` - 已使用（整合到 `ComplexImpedanceModel`）

#### MOD_10 通根增益
- ✅ `PH_ROOTING_GAIN` - 已使用（`ResonanceBooster.calculate_resonance_gain`）

#### MOD_03 合化
- ✅ `PH_COMBINATION_PHASE` - 已使用（`CombinationPhaseEngine.check_combination_phase`）

#### MOD_11 宫位引力
- ✅ `PH_PILLAR_GRAVITY` - 已使用（`PillarGravityEngineV13_7.calculate_dynamic_weights`）
- ✅ `PH_DYNAMIC_GRAVITY_WEIGHTS` - 已使用（新注册）

#### MOD_12 时空惯性
- ✅ `PH_INERTIA_DECAY` - 已使用（新注册）
- ✅ `PH_FLUID_VISCOSITY` - 已使用（`SpacetimeInertiaEngineV13_7.calculate_inertia_weights`）

#### MOD_07 生命轨道
- ✅ `PH_TEMPORAL_RESAMPLING` - 已使用（新注册）
- ✅ `PH_DYNAMIC_DISPERSION_SIN` - 已使用

#### MOD_16 应期预测
- ✅ `PH_WAVEFUNCTION_COLLAPSE` - 已使用（新注册）
- ✅ `PH_NONLINEAR_ACCUMULATION` - 已使用（新注册）

#### MOD_17 星辰相干
- ✅ `PH_STELLAR_ENTROPY_DAMPING` - 已使用（新注册）
- ✅ `PH_STELLAR_SNR_BOOST` - 已注册但可能未完全实现
- ✅ `PH_STELLAR_QUANTUM_ATTRACTION` - 已使用（新注册）
- ✅ `PH_STELLAR_KINETIC_IMPULSE` - 已使用（新注册）

#### MOD_18 全局干涉
- ✅ `PH_CROSS_INTERFERENCE` - 已使用（新注册）

#### 基础设施
- ✅ `PH_INFLUENCE_FACTOR` - 已使用（`InfluenceBus`）
- ✅ `PH_NONLINEAR_TYPE` - 已使用（`InfluenceBus`）
- ✅ `PH_PHYSICS_TENSOR` - 已使用（`InfluenceBus`）
- ✅ `PH_BAZI_PARTICLE_NEXUS` - 已使用（`BaziParticleNexus`）

---

## ⚠️ 可能未使用的注册项

### 规则（需要验证）

1. **PH_PHASE_COLLAPSE** - 已注册但可能未完全实现
   - 描述：模拟情感势能波函数坍缩
   - 状态：需要验证是否在 `RelationshipGravityEngineV13_7` 中使用

2. **PH_PEACH_BLOSSOM** - 已注册但可能未完全实现
   - 描述：将情感吸引力建模为概率波
   - 状态：需要验证是否在 `RelationshipGravityEngineV13_7` 中使用

3. **PH_LUCK_BACKGROUND** - 已注册但可能未完全实现
   - 描述：大运作为引力背景辐射
   - 状态：需要验证是否在 `RelationshipGravityEngineV13_7` 中使用

4. **PH_ANNUAL_IMPULSE** - 已注册但可能未完全实现
   - 描述：流年干支作为高速飞掠天体施加轨道冲量
   - 状态：需要验证是否在 `RelationshipGravityEngineV13_7` 中使用

5. **PH_STELLAR_SNR_BOOST** - 已注册但可能未完全实现
   - 描述：Each Wen Chang (文昌) node improves signal-to-noise ratio by 15%
   - 状态：需要验证是否在 `StellarCoherenceEngineV13_7` 中使用

6. **PH_ENTROPY_OPTIMIZATION** - 已注册但可能未完全实现
   - 描述：在 `MOD_15` 的 `linked_rules` 中，但未找到具体实现

7. **PH_PENALTY_3** - 已注册但可能未完全实现
   - 描述：刑害干涉动力学
   - 状态：需要验证是否在 `MOD_04` 中使用

8. **PH_HARM_6** - 已注册但可能未完全实现
   - 描述：刑害干涉动力学
   - 状态：需要验证是否在 `MOD_04` 中使用

9. **PH_SHEAR_STRESS** - 已注册但可能未完全实现
   - 描述：刑害干涉动力学
   - 状态：需要验证是否在 `MOD_04` 中使用

10. **PH_RISK_NODE_DETECT** - 已注册但可能未完全实现
    - 描述：风险节点探测
    - 状态：需要验证是否在 `LifepathResamplingEngineV13_7` 中使用

11. **PH_SHEAR_BURST** - 已注册但可能未完全实现
    - 描述：羊刃相变（2.26x 增益）
    - 状态：需要验证是否在 `LifepathResamplingEngineV13_7` 中使用

12. **PH_DYNAMIC_DISPERSION_SIN** - 已注册但可能未完全实现
    - 描述：动态弥散（正弦）
    - 状态：需要验证是否在 `LifepathResamplingEngineV13_7` 中使用

---

## 📊 模块注册状态分析

### 已注册且实际使用的模块

| 模块 ID | 名称 | 状态 | 类路径 |
| --- | --- | --- | --- |
| MOD_05_WEALTH | 财富流体力学 | ✅ 已使用 | `WealthFluidEngineV13_7` |
| MOD_06_RELATIONSHIP | 情感引力场 | ✅ 已使用 | `RelationshipGravityEngineV13_7` |
| MOD_02_SUPER | 极高位格局共振 | ✅ 已使用 | `SuperStructureResonanceEngineV13_7` |
| MOD_17_STELLAR_INTERACTION | 星辰相干 | ✅ 已使用 | `StellarCoherenceEngineV13_7` |
| MOD_16_TEMPORAL_SHUNTING | 应期预测 | ✅ 已使用 | `TemporalPredictionEngineV13_7` |
| MOD_11_GRAVITY | 宫位引力场 | ✅ 已使用 | `PillarGravityEngineV13_7` |
| MOD_12_INERTIA | 时空场惯性 | ✅ 已使用 | `SpacetimeInertiaEngineV13_7` |
| MOD_07_LIFEPATH | 个人生命轨道仪 | ✅ 已使用 | `LifepathResamplingEngineV13_7` |
| MOD_18_BASE_APP | 基础应用与全局工具 | ✅ 已使用 | `GlobalInterferenceEngineV13_7` |
| MOD_15_STRUCTURAL_VIBRATION | 结构振动传导 | ✅ 已使用 | `ComplexImpedanceModel` |
| MOD_10_RESONANCE | 干支通根增益 | ✅ 已使用 | `ResonanceBooster` |
| MOD_03_TRANSFORM | 合化动力学 | ✅ 已使用 | `CombinationPhaseEngine` |
| MOD_21_INFLUENCE_BUS | 影响因子总线 | ✅ 已使用 | `InfluenceBus` |

### 已注册但需要验证的模块

| 模块 ID | 名称 | 状态 | 备注 |
| --- | --- | --- | --- |
| MOD_00_SUBSTRATE | 晶格基底 | ⚠️ 需要验证 | 可能仍在使用 |
| MOD_01_TRIPLE | 大一统三元动力 | ⚠️ 需要验证 | 可能仍在使用 |
| MOD_04_STABILITY | 刑害干涉动力学 | ⚠️ 需要验证 | 可能仍在使用 |
| MOD_09_COMBINATION | 天干合化相位 | ⚠️ 需要验证 | 可能已被 `MOD_03` 整合 |
| MOD_14_TIME_SPACE_INTERFERENCE | 多维时空场耦合 | ⚠️ 需要验证 | 可能仍在使用 |

---

## 🧹 清理建议

### 1. 删除未使用的旧引擎文件

以下文件可能已被 V13.7 版本替代，建议删除或标记为废弃：

- `core/trinity/core/engines/wealth_fluid.py` → 已被 `wealth_fluid_v13_7.py` 替代
- `core/trinity/core/engines/relationship_gravity.py` → 已被 `relationship_gravity_v13_7.py` 替代
- `core/trinity/core/engines/temporal_shunting.py` → 已被 `temporal_prediction_v13_7.py` 替代

### 2. 清理未使用的注册项

以下注册项需要验证，如果未使用，建议删除：

1. `PH_PHASE_COLLAPSE` - 如果未在 `RelationshipGravityEngineV13_7` 中使用
2. `PH_PEACH_BLOSSOM` - 如果未在 `RelationshipGravityEngineV13_7` 中使用
3. `PH_LUCK_BACKGROUND` - 如果未在 `RelationshipGravityEngineV13_7` 中使用
4. `PH_ANNUAL_IMPULSE` - 如果未在 `RelationshipGravityEngineV13_7` 中使用
5. `PH_STELLAR_SNR_BOOST` - 如果未在 `StellarCoherenceEngineV13_7` 中使用
6. `PH_ENTROPY_OPTIMIZATION` - 如果未在 `MOD_15` 中使用
7. `PH_PENALTY_3` - 如果未在 `MOD_04` 中使用
8. `PH_HARM_6` - 如果未在 `MOD_04` 中使用
9. `PH_SHEAR_STRESS` - 如果未在 `MOD_04` 中使用

### 3. 补充缺失的溯源信息

以下注册项需要补充完整的溯源信息：

1. `PH_PERTURBATION_3BODY` - 需要补充 `function`、`formula`、`module`、`used_algorithms`
2. `PH_STELLAR_SNR_BOOST` - 需要补充 `function`、`formula`、`module`、`used_algorithms`
3. `PH_PHASE_COLLAPSE` - 需要补充 `function`、`formula`、`module`、`used_algorithms`
4. `PH_PEACH_BLOSSOM` - 需要补充 `function`、`formula`、`module`、`used_algorithms`
5. `PH_LUCK_BACKGROUND` - 需要补充 `function`、`formula`、`module`、`used_algorithms`
6. `PH_ANNUAL_IMPULSE` - 需要补充 `function`、`formula`、`module`、`used_algorithms`

---

## ✅ 下一步行动

1. **验证未使用的注册项**：检查上述规则是否在实际代码中使用
2. **删除未使用的文件**：删除已被 V13.7 替代的旧引擎文件
3. **清理注册表**：从 `logic_manifest.json` 中删除未使用的注册项
4. **补充溯源信息**：为所有使用的规则补充完整的溯源信息
5. **生成最终报告**：生成清理后的注册表状态报告

---

**报告生成时间**: 2025-01-XX  
**状态**: ⏳ 待执行清理操作

