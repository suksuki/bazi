# V11.0 矢量化计算架构设计文档

**版本**: V11.0  
**升级类型**: 架构级升级  
**日期**: 2025-12-18

---

## 🎯 升级目标

从V10.X的"手动调参打地鼠"模式，升级为V11.0的"工业级数学模型"架构：

1. **RANSAC算法** - 数据清洗，自动识别并剔除离群点（脏数据）
2. **SVM分类器** - 替代硬编码阈值，用超平面切割高维特征空间

---

## 🧹 第一阶段：RANSAC数据清洗

### 原理

RANSAC (Random Sample Consensus) 专门用于在充满噪声的数据集中找到正确的数学模型。

**流程**：
1. 随机抽取一小部分案例（如20个）
2. 用这20个案例计算最优参数
3. 用这套参数测试剩余案例，计算符合度（Inlier Count）
4. 重复1000次，找到Inlier数量最多的参数
5. 标记不符合的案例为Outlier（脏数据）

### 实施计划

1. **创建RANSAC诊断脚本**
   - 输入：所有校准案例
   - 输出：Outlier列表、Inlier统计、剔除建议

2. **生成剔除建议名单**
   - 标记为`Dirty_Data`的案例
   - 移入`ignored_cases.json`

3. **验证清洗效果**
   - 用清洗后的数据集重新训练
   - 验证匹配率提升

---

## 🎯 第二阶段：SVM分类器训练

### 原理

SVM (Support Vector Machine) 通过寻找超平面将不同类别最大程度分开。

**特征维度**：
- X轴：`Strength_Score`
- Y轴：`Self_Team_Ratio`
- Z轴：`Root_Depth` (通根深度)
- W轴：`Month_Command` (月令得令系数)

### 实施计划

1. **特征工程**
   - 计算每个案例的多维特征向量
   - 归一化特征

2. **训练SVM分类器**
   - 使用scikit-learn
   - Soft Margin（容错）
   - 输出：模型权重向量

3. **模型集成**
   - 废除`engine_graph.py`中的硬编码阈值
   - 使用SVM模型进行推理

---

## 🛠️ 实施路线图

### Phase 1: RANSAC数据清洗（当前）

- [ ] 创建RANSAC诊断脚本
- [ ] 运行RANSAC分析
- [ ] 生成剔除建议名单
- [ ] 验证清洗效果

### Phase 2: SVM特征工程

- [ ] 计算多维特征向量
- [ ] 特征归一化
- [ ] 数据准备

### Phase 3: SVM训练

- [ ] 训练SVM分类器
- [ ] 模型验证
- [ ] 参数调优

### Phase 4: 模型集成

- [ ] 废除硬编码阈值
- [ ] 集成SVM模型
- [ ] 端到端测试

---

## 📊 预期效果

1. **数据质量提升**
   - 自动识别并剔除脏数据
   - 数据集更加纯净

2. **匹配率提升**
   - 预期突破65%
   - 减少误判

3. **可维护性提升**
   - 不再需要手动调参
   - 模型自动学习最优边界

---

**文档版本**: V11.0.0  
**最后更新**: 2025-12-18

