# ğŸ”® é‡å­æ¡†æ¶åŸºç¡€å‚æ•°ä¸»é¢˜ä½“ç³»

**æ–‡æ¡£ç‰ˆæœ¬**: V1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-30  
**å¯¹åº”é¡µé¢**: âœ¨ é‡å­çœŸè¨€ (Quantum Lab)

---

## ä¸€ã€æ¦‚è¿°

é‡å­æ¡†æ¶çš„åŸºç¡€å‚æ•°ä¸»é¢˜ä½“ç³»å®šä¹‰åœ¨ `core/config_schema.py` çš„ `DEFAULT_FULL_ALGO_PARAMS` ä¸­ï¼Œå¹¶é€šè¿‡ `ui/components/tuning_panel.py` çš„è°ƒä¼˜é¢æ¿åœ¨é‡å­çœŸè¨€é¡µé¢ä¸­å±•ç¤ºå’Œè°ƒæ•´ã€‚

---

## äºŒã€äº”å¤§å‚æ•°ä¸»é¢˜é¢æ¿

### 2.1 é¢æ¿ 1: åŸºç¡€åœºåŸŸ (Field Environment) - `physics`

**ä¸»é¢˜æ ‡è¯†**: âš¡ åŸºç¡€åœºåŸŸ  
**UIä½ç½®**: é‡å­çœŸè¨€é¡µé¢ â†’ è°ƒä¼˜é¢æ¿ â†’ æ ‡ç­¾é¡µ 1

**æ ¸å¿ƒå‚æ•°**:

| å‚æ•°ç»„ | å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|--------|------|
| **å­£èŠ‚æƒé‡** | `seasonWeights` | | æ—ºç›¸ä¼‘å›šæ­»èƒ½é‡ç³»æ•° |
| | `wang` | 1.20 | æ—ºï¼ˆå¾—ä»¤ï¼‰ |
| | `xiang` | 1.00 | ç›¸ï¼ˆæ¬¡æ—ºï¼‰ |
| | `xiu` | 0.90 | ä¼‘ï¼ˆæ³„æ°”ï¼‰ |
| | `qiu` | 0.60 | å›šï¼ˆè¢«å…‹ï¼‰ |
| | `si` | 0.45 | æ­»ï¼ˆè¢«å…‹ä¸¥é‡ï¼‰ |
| **è—å¹²æ¯”ä¾‹** | `hiddenStemRatios` | | åœ°æ”¯è—å¹²èƒ½é‡åˆ†é… |
| | `main` | 0.60 | ä¸»æ°”ï¼ˆ60%ï¼‰ |
| | `middle` | 0.30 | ä¸­æ°”ï¼ˆ30%ï¼‰ |
| | `remnant` | 0.10 | ä½™æ°”ï¼ˆ10%ï¼‰ |
| **å®«ä½å¼•åŠ›** | `pillarWeights` | | å››æŸ±æƒé‡ |
| | `year` | 0.7 | å¹´æ”¯æƒé‡ |
| | `month` | 1.42 | æœˆä»¤æƒé‡ï¼ˆæœ€é«˜ï¼‰ |
| | `day` | 1.35 | æ—¥æ”¯æƒé‡ |
| | `hour` | 0.77 | æ—¶æ”¯æƒé‡ |
| **å…¶ä»–** | `self_punishment_damping` | 0.2 | è‡ªåˆ‘æƒ©ç½š |
| | `season_decay_factor` | 0.3 | å¤±ä»¤è¡°å‡å› å­ |
| | `dayun_branch_multiplier` | 1.2 | å¤§è¿åœ°æ”¯æƒé‡å€æ•° |
| | `dayun_stem_multiplier` | 0.8 | å¤§è¿å¤©å¹²æƒé‡å€æ•° |
| | `liunian_power` | 2.0 | æµå¹´æƒåŠ›ç³»æ•° |
| | `liunian_decay_rate` | 0.9 | æµå¹´èƒ½é‡è¡°å‡ç‡ |

**UIæ˜ å°„**:
- `sw_wang`, `sw_xiang`, `sw_xiu`, `sw_qiu`, `sw_si` â†’ å­£èŠ‚æƒé‡æ»‘å—
- `hs_main`, `hs_mid`, `hs_rem` â†’ è—å¹²æ¯”ä¾‹æ»‘å—
- `pg_y`, `pg_m`, `pg_d`, `pg_h` â†’ å®«ä½æƒé‡æ»‘å—

---

### 2.2 é¢æ¿ 2: ç²’å­åŠ¨æ€ (Particle Dynamics) - `structure`

**ä¸»é¢˜æ ‡è¯†**: âš¡ ç²’å­ç»“æ„  
**UIä½ç½®**: é‡å­çœŸè¨€é¡µé¢ â†’ è°ƒä¼˜é¢æ¿ â†’ æ ‡ç­¾é¡µ 2

**æ ¸å¿ƒå‚æ•°**:

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `rootingWeight` | 1.0 | é€šæ ¹ç³»æ•°ï¼ˆå½’ä¸€åŒ–ï¼‰ |
| `rootingSaturationMax` | 2.5 | é€šæ ¹æœ€å¤§åŠ æˆä¸Šé™ |
| `rootingSaturationSteepness` | 0.8 | é€šæ ¹é¥±å’Œæ›²çº¿é™¡å³­åº¦ |
| `exposedBoost` | 1.5 | é€å¹²åŠ æˆ |
| `samePillarBonus` | 1.5 | è‡ªåå¼ºæ ¹åŠ æƒ |
| `voidPenalty` | 0.45 | ç©ºäº¡æŠ˜æŸ |

**UIæ˜ å°„**:
- `s_rw` â†’ é€šæ ¹æƒé‡æ»‘å—
- `s_eb` â†’ é€å¹²åŠ æˆæ»‘å—
- `s_sp` â†’ è‡ªåå¼ºæ ¹æ»‘å—

---

### 2.3 é¢æ¿ 3: å‡ ä½•äº¤äº’ (Geometric Interactions) - `interactions`

**ä¸»é¢˜æ ‡è¯†**: âš”ï¸ ç”Ÿå…‹ä¸äº‰åˆ  
**UIä½ç½®**: é‡å­çœŸè¨€é¡µé¢ â†’ è°ƒä¼˜é¢æ¿ â†’ æ ‡ç­¾é¡µ 2

**æ ¸å¿ƒå‚æ•°ç»„**:

#### 3.1 å¤©å¹²äº”åˆ (`stemFiveCombination`)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `threshold` | 3.0 | åˆåŒ–é˜ˆå€¼ |
| `bonus` | 1.5 | åˆåŒ–åŠ æˆ |
| `penalty` | 0.7 | ç¾ç»ŠæŸè€— |

#### 3.2 åœ°æ”¯åˆå±€ (`comboPhysics`)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `trineBonus` | 2.5 | ä¸‰åˆå€ç‡ |
| `halfBonus` | 1.5 | åŠä¸‰åˆå€ç‡ |
| `archBonus` | 1.1 | æ‹±åˆå€ç‡ |
| `directionalBonus` | 3.0 | ä¸‰ä¼šå€ç‡ |
| `resolutionCost` | 0.1 | è§£å†²æ¶ˆè€— |

#### 3.3 åœ°æ”¯äº‹ä»¶ (`branchEvents`)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `clashDamping` | 0.4 | å†²çš„æŠ˜æŸ |
| `threeHarmony.bonus` | 1.6 | ä¸‰åˆåŠ æˆ |
| `halfHarmony.bonus` | 1.25 | åŠåˆåŠ æˆ |
| `archHarmony.bonus` | 1.1 | æ‹±åˆåŠ æˆ |
| `sixHarmony.bonus` | 1.15 | å…­åˆåŠ æˆ |
| `sixHarmony.bindingPenalty` | 0.2 | å…­åˆç¾ç»Šæƒ©ç½š |
| `threeMeeting.bonus` | 2.5 | ä¸‰ä¼šå€ç‡ |
| `clashPhase` | 2.618 | å†²çš„ç›¸ä½ï¼ˆ150åº¦ï¼‰ |
| `clashEntropy` | 0.6 | å†²çš„ç†µå¢ |
| `punishPhase` | 2.513 | åˆ‘çš„ç›¸ä½ï¼ˆ144åº¦ï¼‰ |
| `punishEntropy` | 0.7 | åˆ‘çš„ç†µå¢ |
| `resonanceQ` | 1.5 | åœŸåˆ‘æ¿€æ—º |

#### 3.4 å¢“åº“ç‰©ç† (`vault`)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `threshold` | 3.5 | åº“vså¢“çš„èƒ½é‡é˜ˆå€¼ |
| `sealedDamping` | 0.4 | é—­åº“æ—¶çš„èƒ½é‡æŠ˜æŸç‡ |
| `openBonus` | 1.8 | å†²å¼€åçš„çˆ†å‘å€ç‡ |
| `breakPenalty` | 0.5 | å†²ç ´å¢“çš„æƒ©ç½šç³»æ•° |

**UIæ˜ å°„**:
- `p2_combine_threshold`, `p2_combine_bonus`, `p2_combine_penalty` â†’ å¤©å¹²äº”åˆæ»‘å—
- `p2_three_harmony_bonus`, `p2_half_harmony_bonus`, `p2_arch_harmony_bonus`, `p2_six_harmony_bonus` â†’ åˆå±€å€ç‡æ»‘å—
- `p2_vault_thresh`, `p2_vault_sealed`, `p2_vault_open`, `p2_vault_break` â†’ å¢“åº“å‚æ•°æ»‘å—
- `wp_clash_phase`, `wp_clash_entropy`, `wp_punish_phase`, `wp_punish_entropy`, `wp_resonance_q` â†’ æ³¢åŠ¨åŠ›å­¦å‚æ•°æ»‘å—

---

### 2.4 é¢æ¿ 4: èƒ½é‡æµè½¬ (Energy Flow) - `flow`

**ä¸»é¢˜æ ‡è¯†**: ğŸŒŠ èƒ½é‡æµè½¬  
**UIä½ç½®**: é‡å­çœŸè¨€é¡µé¢ â†’ è°ƒä¼˜é¢æ¿ â†’ æ ‡ç­¾é¡µ 5

**æ ¸å¿ƒå‚æ•°ç»„**:

#### 4.1 æµä½“åŠ›å­¦å‚æ•° (Fluid Dynamics)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `generationEfficiency` | 0.7 | ç”Ÿçš„æ•ˆç‡ï¼ˆä¼ è¾“æŸè€—30%ï¼‰ |
| `generationDrain` | 0.3 | æ³„çš„ç¨‹åº¦ï¼ˆç”Ÿåˆ«äººå¾ˆç´¯ï¼‰ |
| `controlImpact` | 0.5 | å…‹çš„ç ´ååŠ›ï¼ˆé˜²æ­¢å…‹è¿‡å¤´ï¼‰ |
| `dampingFactor` | 0.1 | ç³»ç»Ÿé˜»å°¼/ç†µå¢ |

#### 4.2 ç©ºé—´åœºå‚æ•° (Spatial Field)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `spatialDecay.gap0` | 1.0 | è·ç¦»0çš„è¡°å‡ |
| `spatialDecay.gap1` | 0.9 | è·ç¦»1çš„è¡°å‡ |
| `spatialDecay.gap2` | 0.75 | è·ç¦»2çš„è¡°å‡ |
| `spatialDecay.gap3` | 0.6 | è·ç¦»3çš„è¡°å‡ |

#### 4.3 è¾“å…¥é˜»æŠ— (Resource Impedance)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `resourceImpedance.base` | 0.3 | åŸºç¡€é˜»æŠ— |
| `resourceImpedance.weaknessPenalty` | 0.5 | è™šä¸å—è¡¥æƒ©ç½š |

#### 4.4 è¾“å‡ºç²˜æ» (Output Viscosity)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `outputViscosity.maxDrainRate` | 0.6 | æœ€å¤§æ³„è€—ç‡ |
| `outputViscosity.drainFriction` | 0.2 | è¾“å‡ºé˜»åŠ› |

#### 4.5 ç›¸å˜åè®® (Phase Change Protocol)

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `phaseChange.scorchedEarthDamping` | 0.15 | ç„¦åœŸä¸ç”Ÿé‡‘ï¼ˆå¤å­£85%é˜»æ–­ï¼‰ |
| `phaseChange.frozenWaterDamping` | 0.3 | å†»æ°´ä¸ç”Ÿæœ¨ï¼ˆå†¬å­£70%é˜»æ–­ï¼‰ |

**UIæ˜ å°„**:
- `f_ri_b`, `f_ri_wp` â†’ è¾“å…¥é˜»æŠ—æ»‘å—
- `f_ov_mdr`, `f_ov_df` â†’ è¾“å‡ºç²˜æ»æ»‘å—
- `p2_gen_drain`, `p2_ctrl_imp`, `f_damp_fac` â†’ æµä½“åŠ›å­¦æ»‘å—
- `pc_scorched`, `pc_frozen` â†’ ç›¸å˜åè®®æ»‘å—

---

### 2.5 é¢æ¿ 5: æ—¶ç©ºä¿®æ­£ (Spacetime Modifiers) - `spacetime`

**ä¸»é¢˜æ ‡è¯†**: ğŸŒ æ—¶ç©ºä¸èƒŒæ™¯  
**UIä½ç½®**: é‡å­çœŸè¨€é¡µé¢ â†’ è°ƒä¼˜é¢æ¿ â†’ æ ‡ç­¾é¡µ 5

**æ ¸å¿ƒå‚æ•°**:

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `luckPillarWeight` | 1.5 | å¤§è¿èƒŒæ™¯åœºæƒé‡ |
| `annualPillarWeight` | 0.5 | æµå¹´åŠ¨æ€åœºæƒé‡ |
| `geo.latitudeHeat` | 0.08 | æ¯10åº¦çƒ­åŠ›ä¿®æ­£ç³»æ•° |
| `geo.latitudeCold` | 0.08 | æ¯10åº¦å†·åŠ›ä¿®æ­£ç³»æ•° |
| `era.eraBonus` | 0.25 | æ—¶ä»£çº¢åˆ© |
| `era.eraPenalty` | 0.1 | æ—¶ä»£é˜»åŠ› |

**UIæ˜ å°„**:
- `st_luck_w`, `st_annual_w` â†’ å¤§è¿/æµå¹´æƒé‡æ»‘å—
- `st_geo_heat` â†’ åœ°ç†ä¿®æ­£æ»‘å—
- `st_era_bonus` â†’ æ—¶ä»£çº¢åˆ©æ»‘å—

---

## ä¸‰ã€å‚æ•°ä¸»é¢˜ä¸UIçš„å¯¹åº”å…³ç³»

### 3.1 è°ƒä¼˜é¢æ¿æ ‡ç­¾é¡µç»“æ„

```
é‡å­çœŸè¨€é¡µé¢ â†’ ä¾§è¾¹æ è°ƒä¼˜é¢æ¿
â”œâ”€ æ ‡ç­¾é¡µ 1: åˆå§‹èƒ½é‡åœº (Phase 1 & Structure)
â”‚  â”œâ”€ âš¡ ç²’å­ç»“æ„ (Structure)
â”‚  â””â”€ ğŸŒŠ åˆ‘å†²å…‹å®³ (Physics)
â”‚
â”œâ”€ æ ‡ç­¾é¡µ 2: ç”Ÿå…‹ä¸äº‰åˆ (Interactions)
â”‚  â””â”€ âš”ï¸ ç”Ÿå…‹ä¸äº‰åˆ (Interactions)
â”‚
â””â”€ æ ‡ç­¾é¡µ 5: æ—¶ç©ºä¸èƒŒæ™¯ (Phase 3 & Flow)
   â”œâ”€ ğŸŒŠ èƒ½é‡æµè½¬ (Flow)
   â””â”€ ğŸŒ æ—¶ç©ºä¸èƒŒæ™¯ (Spacetime)
```

### 3.2 å‚æ•°è¯»å–æµç¨‹

```
1. é‡å­çœŸè¨€é¡µé¢åŠ è½½
   â†“
2. è°ƒç”¨ render_tuning_panel()
   â†“
3. ä» ConfigModel åŠ è½½é…ç½®
   â†“
4. åˆå§‹åŒ–ç•Œé¢çŠ¶æ€ (åˆå§‹åŒ–ç•Œé¢çŠ¶æ€å‡½æ•°)
   â†“
5. ä» DEFAULT_FULL_ALGO_PARAMS è¯»å–é»˜è®¤å€¼
   â†“
6. æ˜ å°„åˆ° session_state (å‚æ•°æ˜ å°„)
   â†“
7. æ¸²æŸ“UIæ»‘å—
   â†“
8. ç”¨æˆ·è°ƒæ•´ â†’ æ›´æ–° session_state
   â†“
9. åˆå¹¶å›é…ç½® (merge_sidebar_values_to_config)
   â†“
10. ä¿å­˜åˆ° ConfigModel
```

---

## å››ã€å‚æ•°ä¸»é¢˜çš„ä½¿ç”¨åœºæ™¯

### 4.1 A-03 ç¾Šåˆƒæ¶æ€æ ¼è®¡ç®—

**ä½¿ç”¨çš„å‚æ•°ä¸»é¢˜**:
- âœ… **åŸºç¡€åœºåŸŸ** (`physics`): å­£èŠ‚æƒé‡ã€è—å¹²æ¯”ä¾‹ã€å®«ä½æƒé‡
- âœ… **ç²’å­åŠ¨æ€** (`structure`): é€šæ ¹æƒé‡ã€é€å¹²åŠ æˆã€è‡ªåå¼ºæ ¹
- âœ… **å‡ ä½•äº¤äº’** (`interactions`): å†²çš„æŠ˜æŸã€åˆå±€å€ç‡
- âœ… **èƒ½é‡æµè½¬** (`flow`): æµä½“åŠ›å­¦å‚æ•°ã€ç›¸å˜åè®®
- âœ… **æ—¶ç©ºä¿®æ­£** (`spacetime`): å¤§è¿/æµå¹´æƒé‡

**å½“å‰é—®é¢˜** (è§å®¡è®¡æŠ¥å‘Š):
- âŒ `compute_energy_flux` æœªå®Œå…¨ä½¿ç”¨ V2.5 å‚æ•°
- âŒ éƒ¨åˆ†å‚æ•°ç¡¬ç¼–ç ï¼Œæœªä»é…ç½®è¯»å–

---

## äº”ã€å‚æ•°ä¸»é¢˜çš„æ‰©å±•æ€§

### 5.1 æ–°å¢å‚æ•°ä¸»é¢˜

å¦‚éœ€æ–°å¢å‚æ•°ä¸»é¢˜ï¼Œéœ€è¦ï¼š

1. **åœ¨ `config_schema.py` ä¸­æ·»åŠ **:
```python
DEFAULT_FULL_ALGO_PARAMS = {
    # ... ç°æœ‰å‚æ•° ...
    "æ–°ä¸»é¢˜": {
        "å‚æ•°1": é»˜è®¤å€¼1,
        "å‚æ•°2": é»˜è®¤å€¼2,
    }
}
```

2. **åœ¨ `tuning_panel.py` ä¸­æ·»åŠ æ˜ å°„**:
```python
def åˆå§‹åŒ–ç•Œé¢çŠ¶æ€(é…ç½®æ•°æ®, å¼ºåˆ¶=False):
    # ... ç°æœ‰æ˜ å°„ ...
    æ–°ä¸»é¢˜ = é…ç½®æ•°æ®.get('æ–°ä¸»é¢˜', {})
    å‚æ•°æ˜ å°„.update({
        'æ–°å‚æ•°1': æ–°ä¸»é¢˜.get('å‚æ•°1', é»˜è®¤å€¼1),
        'æ–°å‚æ•°2': æ–°ä¸»é¢˜.get('å‚æ•°2', é»˜è®¤å€¼2),
    })
```

3. **åœ¨ `merge_sidebar_values_to_config` ä¸­æ·»åŠ å›å†™**:
```python
def merge_sidebar_values_to_config(config):
    # ... ç°æœ‰å›å†™ ...
    æ–°ä¸»é¢˜ = config.setdefault('æ–°ä¸»é¢˜', {})
    if 'æ–°å‚æ•°1' in st.session_state:
        æ–°ä¸»é¢˜['å‚æ•°1'] = st.session_state['æ–°å‚æ•°1']
```

4. **åœ¨UIä¸­æ·»åŠ æ»‘å—**:
```python
def render_tuning_panel(controller, golden_config):
    # ... ç°æœ‰UI ...
    with st.expander("æ–°ä¸»é¢˜", expanded=True):
        st.slider("å‚æ•°1", ..., key="æ–°å‚æ•°1")
        st.slider("å‚æ•°2", ..., key="æ–°å‚æ•°2")
```

---

## å…­ã€æ€»ç»“

### 6.1 å‚æ•°ä¸»é¢˜ä½“ç³»å®Œæ•´æ€§

âœ… **å·²å®ç°**:
- 5å¤§å‚æ•°ä¸»é¢˜é¢æ¿ï¼ˆåŸºç¡€åœºåŸŸã€ç²’å­åŠ¨æ€ã€å‡ ä½•äº¤äº’ã€èƒ½é‡æµè½¬ã€æ—¶ç©ºä¿®æ­£ï¼‰
- å‚æ•°è¯»å–/ä¿å­˜æœºåˆ¶
- UIè°ƒä¼˜é¢æ¿
- å‚æ•°æ˜ å°„å’Œå›å†™æœºåˆ¶

âš ï¸ **éœ€è¦æ”¹è¿›**:
- éƒ¨åˆ†è®¡ç®—å‡½æ•°æœªå®Œå…¨ä½¿ç”¨å‚æ•°ä¸»é¢˜ï¼ˆå¦‚ `compute_energy_flux`ï¼‰
- éƒ¨åˆ†å‚æ•°ç¡¬ç¼–ç ï¼Œæœªä»é…ç½®è¯»å–

### 6.2 å¯¹é½å»ºè®®

1. **ç«‹å³å¯¹é½**: é‡æ„ `compute_energy_flux` ä½¿ç”¨ V2.5 å‚æ•°ä¸»é¢˜
2. **é€æ­¥å¯¹é½**: æ£€æŸ¥æ‰€æœ‰è®¡ç®—å‡½æ•°ï¼Œç¡®ä¿ä½¿ç”¨å‚æ•°ä¸»é¢˜è€Œéç¡¬ç¼–ç 
3. **æŒç»­å¯¹é½**: æ–°å¢åŠŸèƒ½æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å‚æ•°ä¸»é¢˜è€Œéç¡¬ç¼–ç 

---

**æ–‡æ¡£ç»´æŠ¤**: å½“å‚æ•°ä¸»é¢˜å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¯·æ›´æ–°æœ¬æ–‡æ¡£ã€‚

