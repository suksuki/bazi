# 财富算法逐个案例调整计划

## 📊 当前状态

- **总体命中率**: 约 20% (4/19)
- **平均误差**: 约 70 分
- **总事件数**: 19 个
- **正确事件**: 4 个

---

## 🎯 调整优先级

### 高优先级（误差 > 100）

1. **Elon Musk 2021年** (辛丑): 真实=100, 预测=-48, 误差=148
   - 问题：方向错误，身弱财多被识别为债务
   - 需要：检查丑库打开机制

2. **Elon Musk 2008年** (戊子): 真实=-90, 预测=34, 误差=124
   - 问题：未识别冲提纲（子午冲）
   - 需要：检查冲提纲判断逻辑

3. **Elon Musk 2000年** (庚辰): 真实=-50, 预测=78, 误差=128
   - 问题：方向错误，应该识别为危机
   - 需要：检查七杀攻身机制

4. **Jason A 2010年** (庚寅): 真实=100, 预测=0, 误差=100
   - 问题：未识别合开官库（寅合未）
   - 需要：检查合开官库机制

5. **Jason A 2018年** (戊戌): 真实=100, 预测=7.1, 误差=92.9
   - 问题：未识别开库机制
   - 需要：检查戌库打开机制

### 中优先级（误差 50-100）

6. **Jason B 1999年** (己卯): 真实=100, 预测=-16, 误差=116
7. **Jason D 2021年** (辛丑): 真实=100, 预测=-18.9, 误差=118.9
8. **Jason D 2015年** (乙未): 真实=100, 预测=48, 误差=52
9. **Elon Musk 1999年** (己卯): 真实=60, 预测=100, 误差=40
10. **Elon Musk 2002年** (壬午): 真实=80, 预测=34, 误差=46

---

## 📝 调整计划

### 案例 1: Jason A 2010年 (庚寅) - 合开官库

**问题**: 未识别寅合未（合开官库）

**当前逻辑**: 
- 检查了合开财库和合开官库
- 但可能未正确识别未是官库

**调整方向**:
1. 检查未库的元素类型（应该是木库，日主壬水，木是食伤，不是官）
2. 确认官库的定义（日主壬水，克我者为官，土是官）
3. 未是土库，但未中藏干是己土、丁火、乙木
4. 需要检查：未库中是否包含官星（土）

**代码位置**: `core/engine_graph.py` 第 3157-3204 行

---

### 案例 2: Jason A 2018年 (戊戌) - 戌库打开

**问题**: 未识别戌库打开

**当前逻辑**:
- 检查了冲开财库
- 检查了合开财库
- 检查了流年财库被引动

**调整方向**:
1. 检查戌是否是财库（日主壬水，我克者为财，火是财）
2. 戌是火库，应该是财库
3. 检查是否有冲或合触发开库
4. 流年戊戌，戌是流年地支，需要检查原局是否有对应的冲支或合支

**代码位置**: `core/engine_graph.py` 第 3134-3222 行

---

### 案例 3: Elon Musk 2008年 (戊子) - 冲提纲

**问题**: 未识别冲提纲（子午冲）

**当前逻辑**:
- 检查了冲提纲（第 3474-3556 行）
- 但可能判断条件有问题

**调整方向**:
1. 确认月支是午
2. 确认流年地支是子
3. 确认子午冲关系
4. 检查是否有帮身或通关机制（可能误判）

**代码位置**: `core/engine_graph.py` 第 3474-3556 行

---

### 案例 4: Elon Musk 2021年 (辛丑) - 丑库打开

**问题**: 身弱财多被识别为债务，但实际是财富爆发

**当前逻辑**:
- 检查了身弱财重（第 3366-3416 行）
- 检查了库打开机制

**调整方向**:
1. 检查丑是否是财库（日主甲木，我克者为财，土是财）
2. 丑是金库，不是财库
3. 但丑中藏干是己土、癸水、辛金
4. 需要检查：丑库打开是否也能带来财富（通过其他机制）

**代码位置**: `core/engine_graph.py` 第 3134-3222 行，第 3366-3416 行

---

### 案例 5: Elon Musk 2000年 (庚辰) - 七杀攻身

**问题**: 方向错误，应该识别为危机

**当前逻辑**:
- 检查了地支坐财
- 检查了强根
- 但未检查七杀攻身

**调整方向**:
1. 流年天干庚是日主甲木的七杀
2. 需要检查七杀攻身的机制
3. 如果身弱且无帮身，七杀攻身应该是负值

**代码位置**: 需要添加七杀攻身检测

---

## 🔧 实施步骤

1. **逐个案例分析**: 详细分析每个案例的八字、大运、流年
2. **定位问题**: 找出算法中未正确识别的机制
3. **调整算法**: 修改或添加相应的检测逻辑
4. **验证效果**: 运行调试脚本，检查改进效果
5. **迭代优化**: 根据结果继续调整

---

**最后更新**: 2025-01-XX  
**状态**: 🚧 进行中

