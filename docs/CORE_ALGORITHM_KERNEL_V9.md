# Antigravity Core Algorithm Kernel V9.0
# "First Principles" Physics Model
# ==================================
# 
# This is the ABSOLUTE foundation of the Antigravity engine.
# ALL implementations MUST strictly adhere to these 12 definitions.
# 
# CRITICAL CONSTRAINT: NO hard-coded parameters!
# All numerical values are INITIAL VARIABLES with tuning interfaces.

---

## 0. æ ¸å¿ƒçº¦æŸ (Core Constraints)

```
âš ï¸ æ‰€æœ‰å‚æ•°å¿…é¡»å¯é…ç½®ï¼
âš ï¸ æ‰€æœ‰æ•°å€¼å¿…é¡»æœ‰å›å½’éªŒè¯æ¥å£ï¼
âš ï¸ ç¦æ­¢ç¡¬ç¼–ç ï¼
```

---

## 1. åŸºç¡€ç‰©ç†å±‚ (Physics Base)

### 1.1 é˜´é˜³ (Yin/Yang) - è‡ªæ—‹ (Spin)
- **é˜³ (Yang)**: å‘æ•£æ€ (+), å‘å¤–è¾å°„èƒ½é‡
- **é˜´ (Yin)**: æ”¶æ•›æ€ (-), å‘å†…èšåˆèƒ½é‡

### 1.2 äº”è¡Œ (5 Elements) - çŸ¢é‡åœº (Vector Fields)
- **ç”Ÿ (Generation)**: èƒ½é‡ä¼ é€’ï¼Œæ•ˆç‡ < 1.0
- **å…‹ (Control)**: çŸ¢é‡å¯¹æŠ—ï¼Œèƒ½é‡æŸè€—

```
ç”Ÿæˆå¾ªç¯: Wood â†’ Fire â†’ Earth â†’ Metal â†’ Water â†’ Wood
å…‹åˆ¶å¾ªç¯: Wood â†’ Earth â†’ Water â†’ Fire â†’ Metal â†’ Wood
```

---

## 2. ç²’å­ç›¸æ€å®šä¹‰ (Particle Phases)

### 2.1 å¤©å¹² (Stems) - æ³¢å½¢æ€ (Waveforms)

| # | å¤©å¹² | è‹±æ–‡ | ç‰©ç†æ¨¡å‹ | æè¿° |
|---|------|------|----------|------|
| 1 | ç”² | Jia | Vertical Pulse | å‚ç›´è„‰å†² (Tension/Tree) |
| 2 | ä¹™ | Yi | Horizontal Network | æ°´å¹³ç½‘ç»œ (Network/Grass) |
| 3 | ä¸™ | Bing | Omnidirectional Radiation | å…¨å‘è¾å°„ (Radiation/Sun) |
| 4 | ä¸ | Ding | Focused Laser | èšç„¦æ¿€å…‰ (Laser/Candle) |
| 5 | æˆŠ | Wu | High-Density Mass | é«˜å¯†è´¨é‡ (Mass/Mountain) |
| 6 | å·± | Ji | Porous Matrix | å¤šå­”åŸºè´¨ (Matrix/Soil) |
| 7 | åºš | Geng | Rough Impact | ç²—ç³™å†²å‡» (Impact/Ore) |
| 8 | è¾› | Xin | Precision Lattice | ç²¾å¯†æ™¶æ ¼ (Crystal/Jewelry) |
| 9 | å£¬ | Ren | Momentum Fluid | åŠ¨é‡æµä½“ (Momentum/Tsunami) |
| 10 | ç™¸ | Gui | Permeation Field | æ¸—é€åœº (Permeability/Mist) |

### 2.2 åœ°æ”¯ (Branches) - åœºåŸŸç¯å¢ƒ (Field Environments)

| # | åœ°æ”¯ | è‹±æ–‡ | ç‰©ç†æ¨¡å‹ | æè¿° |
|---|------|------|----------|------|
| 1 | å­ | Zi | Abyss | æå¯’æ·±æ¸Š |
| 2 | ä¸‘ | Chou | Frozen Soil | å†»åœŸ/é‡‘åº“ |
| 3 | å¯… | Yin | Reactor | åŠ é€Ÿååº”å † |
| 4 | å¯ | Mao | Jungle | ç”Ÿå‘½å¯†åº¦åœº |
| 5 | è¾° | Chen | Reservoir | æ°´åº“/æ¹¿åœŸ |
| 6 | å·³ | Si | Magnetic Bottle | ç£çº¦æŸç“¶ |
| 7 | åˆ | Wu | Furnace | çƒ­è¾å°„æå€¼ |
| 8 | æœª | Wei | Desert | ç‡¥åœŸ/æœ¨åº“ |
| 9 | ç”³ | Shen | Mineral | é‡‘å±çŸ¿è„‰ |
| 10 | é…‰ | You | Blade | çº¯ç²¹æ™¶ä½“åœº |
| 11 | æˆŒ | Xu | Volcano | ç«åº“/é«˜å‹åŒº |
| 12 | äº¥ | Hai | Ocean | åŸå§‹æ±¤ |

---

## 3. ç»“æ„ç®—æ³• (Structure)

### 3.1 åœ°æ”¯å£³æ ¸æ¨¡å‹ (Shell-Core Model)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            SHELL (å£³)               â”‚
â”‚  - å¤–éƒ¨ç‰©ç†å±æ€§                      â”‚
â”‚  - å†²åˆäº¤äº’æ¥å£                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            CORE (æ ¸)                â”‚
â”‚  - è—å¹²èƒ½é‡åˆ†å¸ƒ                      â”‚
â”‚  - ä¸»æ°”/ä¸­æ°”/ä½™æ°”                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è—å¹²èƒ½é‡åˆ†å¸ƒ (Hidden Stem Distribution)

```python
# åˆå§‹å‚æ•° [éœ€æ ¡éªŒ]
HIDDEN_STEM_RATIOS = {
    "main": 0.60,     # ä¸»æ°” 60%
    "middle": 0.30,   # ä¸­æ°” 30%
    "residual": 0.10  # ä½™æ°” 10%
}
```

---

## 4. å‡ ä½•äº¤äº’ç®—æ³• (Geometric Interaction)

### 4.1 åœ°æ”¯äº¤äº’ - 12é•¿ç”Ÿç›¸ä½è§’ (Phase Angles)

```
                    å­(0Â°)
                      â”‚
          äº¥(30Â°)     â”‚     ä¸‘(330Â°)
                \     â”‚     /
                 \    â”‚    /
      æˆŒ(60Â°) â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¯…(300Â°)
                 /    â”‚    \
                /     â”‚     \
          é…‰(90Â°)     â”‚     å¯(270Â°)
                      â”‚
                    åˆ(180Â°)

å†² (180Â°): èƒ½é‡æ¹®ç­/é‡Šæ”¾ (å­-åˆ, å¯…-ç”³, å¯-é…‰, è¾°-æˆŒ, å·³-äº¥, ä¸‘-æœª)
åˆ (120Â°/60Â°): ç›¸ä½é”å®š/å…±æŒ¯ (ä¸‰åˆ/å…­åˆ)
åˆ‘ (90Â°/ç‰¹æ®Šè§’): å‰ªåˆ‡åŠ›/ç»“æ„ç ´å
å®³ (ç‰¹æ®Šè§’): å¹²æ‰°/æš—æ–—
```

### 4.2 å¤©å¹²äº¤äº’ - æ²³å›¾æ•°ç† (Vector Resonance)

```
ç›¸ä½å·® = 5 â†’ åŒ–åˆååº” (å¤©å¹²äº”åˆ)

ç”²(1) + å·±(6) â†’ åœŸ
ä¹™(2) + åºš(7) â†’ é‡‘
ä¸™(3) + è¾›(8) â†’ æ°´
ä¸(4) + å£¬(9) â†’ æœ¨
æˆŠ(5) + ç™¸(10) â†’ ç«
```

---

## 5. åŠ¨åŠ›å­¦åšåŠŸ (Dynamics & Work)

### 5.1 å‚ç›´ä½œç”¨ (Vertical Interaction)
- **é€šæ ¹ (Rooting)**: å¤©å¹²åœ¨åœ°æ”¯æ‰¾åˆ°åŒå±æ€§è—å¹²ï¼Œèƒ½é‡ç¨³å›º
- **é€å¹² (Projection)**: è—å¹²æ˜¾éœ²äºå¤©å¹²ï¼Œèƒ½é‡æ”¾å¤§

### 5.2 æ°´å¹³ä¼ å¯¼ (Horizontal Conduction)
- **è·ç¦»è¡°å‡**: $K_{distance} = \frac{1}{D^2}$
- **ç”Ÿå…‹é˜»åŠ›**: å—äº”è¡Œå…³ç³»è°ƒèŠ‚

### 5.3 åšåŠŸå…¬å¼ (Work Formula)

```math
Work = Energy Ã— Efficiency Ã— K_{distance} Ã— K_{relation}
```

---

## 6. æ—¶ç©ºä½“ç³» (Spacetime System)

### 6.1 å¤§è¿ (Luck Pillar) - é™æ€èƒŒæ™¯
- ä½œç”¨: é‡å†™åŸå±€ç‰©ç†å¸¸æ•°
- å‘¨æœŸ: 10å¹´/æ­¥
- å½±å“: æ”¹å˜åŸºç¡€åœºåŸŸå‚æ•°

### 6.2 æµå¹´ (Annual Pillar) - åŠ¨æ€è§¦å‘
- ä½œç”¨: é«˜èƒ½ç²’å­æ’å‡»åŸå±€ç«¯å£
- å‘¨æœŸ: 1å¹´
- å½±å“: è§¦å‘äº‹ä»¶/æ¿€æ´»æ½œèƒ½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åŸå±€ (Birth Chart)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ å¹´æŸ± â”‚ æœˆæŸ± â”‚ æ—¥æŸ± â”‚ æ—¶æŸ± â”‚ â† é™æ€ç»“æ„      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â†‘            â†‘                     â”‚
â”‚      å¤§è¿èƒŒæ™¯åœº      æµå¹´è§¦å‘å™¨               â”‚
â”‚  (Static Field)   (Dynamic Trigger)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ç©ºé—´ä¿®æ­£ ($K_{geo}$)

### 7.1 å…¬ç†
```
å‘½è¿ = f(æ—¶é—´, ç©ºé—´)
```

### 7.2 ç»çº¬åº¦ä¿®æ­£

```python
# åˆå§‹å‚æ•° [éœ€æ ¡éªŒ]
def calculate_geo_modifier(latitude, longitude, birth_chart):
    """
    çº¬åº¦ä¿®æ­£å¯’æš– (Temperature Modifier)
    åœ°å½¢ä¿®æ­£ç‡¥æ¹¿ (Humidity Modifier)
    """
    K_temperature = interpolate_latitude(latitude)  # åŒ—æ–¹åå¯’ï¼Œå—æ–¹åæš–
    K_humidity = interpolate_terrain(longitude)     # æ²¿æµ·åæ¹¿ï¼Œå†…é™†åç‡¥
    
    return K_temperature * K_humidity
```

---

## 8. æ¦‚ç‡è®¡ç®— (Probability)

### 8.1 åºŸé™¤å®¿å‘½è®º
- âŒ ä¸è¾“å‡ºç»å¯¹ç»“è®º
- âœ… è¾“å‡ºæ¦‚ç‡åˆ†å¸ƒ

### 8.2 é‡å­æ³¢å‡½æ•° (Wave Function)

```python
def calculate_destiny_probability(state, context):
    """
    è¾“å‡º: æ¦‚ç‡åˆ†å¸ƒï¼Œè€Œéå•ä¸€ç»“è®º
    
    Example:
    {
        "strong": 0.65,  # 65% èº«å¼ºæ¦‚ç‡
        "weak": 0.30,    # 30% èº«å¼±æ¦‚ç‡
        "follower": 0.05 # 5% ä»æ ¼æ¦‚ç‡
    }
    """
    wave_function = superpose_states(state, context)
    return collapse_to_probability(wave_function)
```

---

## 9. æ¼”åŒ–æœºåˆ¶ (Evolution)

### 9.1 æ ¸å¿ƒæŒ‡ä»¤

```
âš ï¸ æ‰€æœ‰å‚æ•°ä¸è¦å†™æ­»ï¼
âš ï¸ å¿…é¡»å»ºç«‹åé¦ˆå›è·¯ï¼
âš ï¸ åˆ©ç”¨çœŸå®æ¡ˆä¾‹è¿›è¡Œå›å½’éªŒè¯ï¼
```

### 9.2 å‚æ•°è°ƒä¼˜æ¡†æ¶

```python
# å¯è°ƒå‚æ•°æ³¨å†Œè¡¨
TUNABLE_PARAMS = {
    # åŸºç¡€ç‰©ç†
    "hidden_stem_ratios": {"main": 0.6, "middle": 0.3, "residual": 0.1},
    "pillar_weights": {"year": 0.8, "month": 2.0, "day": 1.0, "hour": 0.9},
    
    # äº¤äº’å‚æ•°
    "clash_damping": 0.5,
    "combination_bonus": 1.5,
    "punishment_penalty": -0.3,
    
    # æµè½¬å‚æ•°
    "generation_efficiency": 0.7,
    "control_impact": 0.5,
    "spatial_decay": {"gap1": 0.6, "gap2": 0.3},
    
    # ç›¸å˜å‚æ•° [V8.0]
    "scorched_earth_damping": 0.15,
    "frozen_water_damping": 0.3,
    
    # é˜ˆå€¼
    "energy_threshold_strong": 3.5,
    "energy_threshold_weak": 2.0
}

def regression_tune(params, real_cases):
    """
    åˆ©ç”¨çœŸå®æ¡ˆä¾‹ V_real è¿›è¡Œå›å½’è°ƒä¼˜
    """
    for case in real_cases:
        predicted = calculate(case, params)
        actual = case.ground_truth
        loss = compute_loss(predicted, actual)
        
        # åå‘ä¼ æ’­è°ƒæ•´å‚æ•°
        params = gradient_descent(params, loss)
    
    return optimized_params
```

---

## 10. å®ç°æ£€æŸ¥æ¸…å• (Implementation Checklist)

| # | æ¨¡å— | çŠ¶æ€ | æ–‡ä»¶ |
|---|------|------|------|
| 1 | åŸºç¡€ç‰©ç†å±‚ | âœ… | `core/constants.py` |
| 2 | ç²’å­å®šä¹‰ | âœ… | `core/calculator.py` |
| 3 | å£³æ ¸æ¨¡å‹ | âœ… | `core/constants.py` (HIDDEN_STEMS_MAP) |
| 4 | å‡ ä½•äº¤äº’ | âœ… | `core/engines/harmony_engine.py` |
| 5 | åŠ¨åŠ›å­¦åšåŠŸ | âœ… | `core/engines/flow_engine.py` |
| 6 | æ—¶ç©ºä½“ç³» | âœ… | `core/engines/luck_engine.py` |
| 7 | ç©ºé—´ä¿®æ­£ | ğŸ”¶ | `core/config_schema.py` (macroPhysics) |
| 8 | æ¦‚ç‡è®¡ç®— | â³ | TODO: V9.0 |
| 9 | æ¼”åŒ–æœºåˆ¶ | âœ… | `core/config_schema.py` (å…¨å‚æ•°åŒ–) |
| 10 | ç›¸å˜åè®® | âœ… | `core/engines/flow_engine.py` (V8.0) |

---

## Version History

| Version | Date | Description |
|---------|------|-------------|
| V1.0 | 2024-12 | Initial Constitution |
| V6.0 | 2025-12-13 | Oracle Edition (BaziProfile) |
| V7.4 | 2025-12-14 | Physicist Edition (Damping Protocol) |
| V8.0 | 2025-12-14 | Phase Change Protocol |
| V9.0 | TBD | First Principles Kernel (This Spec) |

---

**END OF CORE ALGORITHM KERNEL SPECIFICATION**
