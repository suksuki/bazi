# 📥 Jason案例导入指南

**版本**: V9.3  
**状态**: ✅ 转换脚本已就绪

---

## 📋 概述

已成功创建转换脚本，将Gemini格式的5个案例转换为Jason格式并导入系统。

---

## 🎯 5个Jason案例

### 1. Jason A (财富爆发)
- **ID**: `JASON_A_T1978_1115`
- **八字**: 戊午 癸亥 壬戌 丁未
- **日主**: 壬
- **特点**: 身强用财官，日坐财库，墓库逢冲
- **事件**: 4个（2004创业、2010投资爆发、2012债务危机、2018上市成功）

### 2. Jason B (身弱用印)
- **ID**: `JASON_B_T1964_0910`
- **八字**: 甲辰 癸酉 己亥 戊辰
- **日主**: 己
- **特点**: 身弱用印，财官相生，强金制木
- **事件**: 3个（1999创业、2007收购、2014上市）

### 3. Jason C (稳定积累)
- **ID**: `JASON_C_T1980_0920`
- **八字**: 庚申 乙酉 辛未 甲午
- **日主**: 辛
- **特点**: 身旺用财官，官印相生，平衡格局
- **事件**: 3个（2007升职、2013购房、2017再次升职）

### 4. Jason D (财库连冲)
- **ID**: `JASON_D_T1961_1010`
- **八字**: 辛丑 丁酉 庚辰 丙戌
- **日主**: 庚
- **特点**: 身旺用官，多财库，丑未戌三刑
- **事件**: 3个（1999扩张、2015资产重组、2021投资获利）

### 5. Jason E (截脚测试)
- **ID**: `JASON_E_T1955_0224`
- **八字**: 乙未 戊寅 壬午 庚戌
- **日主**: 壬
- **特点**: 极弱格局，财星强旺，截脚测试
- **事件**: 3个（1985危机、2003健康、2011损失）

---

## 🚀 导入方式

### 方式一：运行转换脚本（推荐）

```bash
python3 scripts/convert_gemini_to_jason.py
```

脚本将：
1. 自动转换Gemini格式为Jason格式
2. 计算实际大运（使用BaziProfile）
3. 将事件转换为timeline格式
4. 自动导入到系统

### 方式二：通过UI导入

1. 启动应用：`streamlit run main.py`
2. 访问"💰 财富验证"页面
3. 在侧边栏上传JSON文件
4. 点击"导入案例"

**注意**: 需要先将转换后的JSON文件保存到本地。

---

## 📝 转换逻辑

### 1. 基本信息提取
- `id`: 保持原ID
- `name`: 从`profile.name`提取
- `gender`: M → 男, F → 女
- `bazi`: 从`chart`提取四柱
- `day_master`: 从日柱提取

### 2. 大运计算
- 使用`BaziProfile`根据出生日期和性别计算实际大运
- 如果计算失败，使用默认值"甲子"

### 3. 流年计算
- 使用干支算法计算流年干支
- 公式：`(year - 4) % 10` 和 `(year - 4) % 12`

### 4. 财富值映射
根据事件描述和类型映射财富值：

| 事件类型 | 关键词 | 财富值 |
|---------|--------|--------|
| 财富爆发 | 爆发、暴增、上市、巨额投资 | 100.0 |
| 重大危机 | 巨大债务、资金链断裂、重大损失 | -90.0 |
| 稳定增长 | 升职加薪、重要收购、大笔购入 | 70.0 |
| 创业起步 | 首次创业、创业成功、业务扩张 | 50.0 |

---

## ✅ 验证清单

导入后，请验证：

- [ ] 所有5个案例都已导入
- [ ] 每个案例的八字正确
- [ ] 每个案例的事件数量正确
- [ ] 大运计算正确（可在UI中查看）
- [ ] 财富值映射合理（可在验证结果中查看）

---

## 🔍 故障排除

### 问题1：大运计算失败
**原因**: BaziProfile初始化失败  
**解决**: 检查出生日期格式，脚本会自动使用默认值"甲子"

### 问题2：导入失败
**原因**: 数据格式不匹配  
**解决**: 检查JSON格式，确保符合WealthCaseModel的要求

### 问题3：财富值不准确
**原因**: 事件描述关键词未匹配  
**解决**: 可在UI中手动调整`real_magnitude`值

---

## 📊 预期结果

导入成功后，您应该看到：

1. **案例列表**: 5个案例出现在"💰 财富验证"页面
2. **验证结果**: 可以点击"🚀 开始验证"查看预测结果
3. **统计信息**: 命中率、平均误差等指标
4. **详细分析**: 每个事件的触发机制和问题诊断

---

## 🎯 下一步

1. **运行验证**: 在UI中选择案例并运行验证
2. **分析结果**: 查看预测值与真实值的对比
3. **调优算法**: 根据验证结果调整财富引擎参数
4. **扩展案例**: 添加更多案例以提升模型准确性

---

**文档更新时间**: 2024  
**维护者**: Quantum Bazi GEM Team

