# V9.4 "Non-linear Saturation" ç®—æ³•å®ç°æŠ¥å‘Š

**ç‰ˆæœ¬**: V9.4  
**æ—¥æœŸ**: 2025-12-19  
**çŠ¶æ€**: å®æ–½å®Œæˆï¼Œè°ƒä¼˜ä¸­  
**é€šè¿‡ç‡**: 10.0% (1/10)

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦ (Executive Summary)

æœ¬æŠ¥å‘Šè¯¦ç»†è®°å½•äº†V9.4 "Non-linear Saturation"ç®—æ³•çš„å®Œæ•´å®ç°è·¯å¾„ï¼ŒåŒ…æ‹¬ï¼š
- æ ¸å¿ƒç®—æ³•å…¬å¼ï¼ˆSigmoidæ”»é˜²å·®åˆ†ã€é˜ˆå€¼ç”Ÿå‘ï¼‰
- ä»£ç å®ç°ç»†èŠ‚
- è®¡ç®—è·¯å¾„åˆ†æ
- æµ‹è¯•ç»“æœä¸é—®é¢˜è¯Šæ–­
- è°ƒä¼˜å»ºè®®

---

## ğŸ¯ ç®—æ³•è®¾è®¡ç›®æ ‡

### æ ¸å¿ƒé—®é¢˜
1. **å…‹åˆ¶ä¼¤å®³è¿‡å¼º**ï¼šçº¿æ€§å‡æ³•å¯¼è‡´"æ¯æ°´è½¦è–ª"åœºæ™¯å¤±è´¥ï¼ˆå¼±æ°´å…‹å¼ºç«ï¼Œç«è¢«å®Œå…¨æ¹®ç­ï¼‰
2. **å¼±æœ¨ç”Ÿç«å¤±æ•ˆ**ï¼šèƒ½é‡ä¸è¶³çš„æºèŠ‚ç‚¹ä»èƒ½äº§ç”Ÿè¾“å‡ºï¼ˆè¿åç‰©ç†å®šå¾‹ï¼‰
3. **åˆåŒ–èƒ½é‡æš´æ¶¨**ï¼šçº¿æ€§ä¹˜æ³•å¯¼è‡´æ•°å€¼æº¢å‡ºï¼ˆå¦‚F5æ¡ˆä¾‹ï¼š2.203å€ï¼‰
4. **åŠåˆ/æ‹±åˆå¤±æ•ˆ**ï¼šé€»è¾‘åˆ†æ”¯é”™è¯¯ï¼Œæ‰å…¥penaltyåˆ†æ”¯

### è§£å†³æ–¹æ¡ˆ
- **Sigmoidæ”»é˜²å·®åˆ†**ï¼šä½¿ç”¨Så‹æ›²çº¿å¤„ç†å¼ºå¼±æ‚¬æ®Šåœºæ™¯
- **é˜ˆå€¼ç”Ÿå‘**ï¼šå¼•å…¥æ¿€æ´»èƒ½é‡é˜ˆå€¼ï¼Œå¼±æºæ— æ³•ç”Ÿå‘
- **é¥±å’Œè¡°å‡**ï¼šåˆåŒ–èƒ½é‡ä½¿ç”¨æŒ‡æ•°è¡°å‡ï¼Œé˜²æ­¢æ•°å€¼çˆ†ç‚¸
- **æ˜¾å¼é€»è¾‘åˆ†æ”¯**ï¼šä¿®å¤åŠåˆ/æ‹±åˆæ£€æµ‹é€»è¾‘

---

## ğŸ”¬ æ ¸å¿ƒç®—æ³•å…¬å¼

### 1. å…‹åˆ¶ä¼¤å®³è®¡ç®— (Control Damage)

**å…¬å¼**: `Damage = Defender Ã— BaseImpact Ã— Sigmoid((Attacker - Defender) / k)`

**æ•°å­¦è¡¨è¾¾å¼**:
```
Dmg = Def Ã— 0.8 Ã— (1 / (1 + e^(-(Atk - Def)/10)))
```

**å‚æ•°**:
- `BaseImpact = 0.8`ï¼šåŸºç¡€ä¼¤å®³ç³»æ•°
- `k = 10.0`ï¼šå¹³æ»‘ç³»æ•°ï¼ˆå†³å®š"ç ´é˜²"éš¾åº¦ï¼‰
- `Sigmoid(x) = 1 / (1 + e^(-x))`ï¼šSå‹æ¿€æ´»å‡½æ•°

**ç‰©ç†æ„ä¹‰**:
- å½“ `Atk >> Def` æ—¶ï¼š`Sigmoid(å¤§æ­£æ•°) â†’ 1.0`ï¼Œä¼¤å®³æ¥è¿‘ `Def Ã— 0.8`
- å½“ `Atk << Def` æ—¶ï¼š`Sigmoid(å¤§è´Ÿæ•°) â†’ 0.0`ï¼Œä¼¤å®³æ¥è¿‘ `0`ï¼ˆåå…‹æœºåˆ¶ï¼‰

**å®ç°ä½ç½®**: `core/engines/flow_engine.py::calculate_control_damage()`

```python
@staticmethod
def calculate_control_damage(attacker_energy: float, defender_energy: float, base_impact: float = 0.8) -> float:
    if attacker_energy <= 0 or defender_energy <= 0:
        return 0.0
    
    k_smoothness = 10.0
    diff = attacker_energy - defender_energy
    exponent_input = -diff / k_smoothness
    exponent_input = max(-50, min(50, exponent_input))  # é˜²æº¢å‡º
    
    activation = 1.0 / (1.0 + math.exp(exponent_input))
    damage = defender_energy * base_impact * activation
    
    return damage
```

**æ•°å­¦éªŒè¯**:
- E1æ¡ˆä¾‹ï¼ˆå¼ºæ°´50å…‹ç«40ï¼‰ï¼šä¼¤å®³=23.39ï¼Œå‰©ä½™æ¯”ç‡=0.4152 âœ…
- E2æ¡ˆä¾‹ï¼ˆå¼±æ°´2å…‹å¼ºç«100ï¼‰ï¼šä¼¤å®³=0.0044ï¼Œå‰©ä½™æ¯”ç‡=1.0000 âœ…

---

### 2. ç”Ÿå‘èƒ½é‡è®¡ç®— (Generation Output)

**å…¬å¼**: `Output = max(0, (Mother - Threshold) Ã— Efficiency)`

**æ•°å­¦è¡¨è¾¾å¼**:
```
Out = max(0, (Mother - 5.0) Ã— 0.7)
```

**å‚æ•°**:
- `Threshold = 5.0`ï¼šæ¿€æ´»èƒ½é‡é˜ˆå€¼
- `Efficiency = 0.7`ï¼šç”Ÿæˆæ•ˆç‡ï¼ˆä»é…ç½®è¯»å–ï¼‰

**ç‰©ç†æ„ä¹‰**:
- å½“ `Mother < 5.0` æ—¶ï¼šè¾“å‡º = 0ï¼ˆå¼±æœ¨æ— æ³•ç”Ÿç«ï¼‰
- å½“ `Mother â‰¥ 5.0` æ—¶ï¼šè¾“å‡º = (Mother - 5.0) Ã— 0.7

**å®ç°ä½ç½®**: `core/engines/flow_engine.py::calculate_generation()`

```python
@staticmethod
def calculate_generation(mother_energy: float, efficiency: float) -> float:
    ACTIVATION_THRESHOLD = 5.0
    effective_source = mother_energy - ACTIVATION_THRESHOLD
    
    if effective_source <= 0:
        return 0.0
        
    return effective_source * efficiency
```

**æ•°å­¦éªŒè¯**:
- D2æ¡ˆä¾‹ï¼ˆå¼±æœ¨3.3ç”Ÿç«ï¼‰ï¼šè¾“å‡º = max(0, (3.3 - 5.0) Ã— 0.7) = 0.0 âœ…

---

### 3. åˆåŒ–èƒ½é‡è®¡ç®— (Combination Bonus)

**å½“å‰å®ç°**: ä½¿ç”¨é…ç½®ä¸­çš„bonuså€¼ç›´æ¥ä¹˜æ³•

**é…ç½®å‚æ•°**:
```json
{
  "threeHarmony": {"bonus": 1.8},
  "halfHarmony": {"bonus": 1.5},
  "archHarmony": {"bonus": 1.2},
  "sixHarmony": {"bonus": 1.4},
  "stemFiveCombination": {"transformBonus": 1.2}
}
```

**é—®é¢˜**: F2-F4æ¡ˆä¾‹æ˜¾ç¤ºèƒ½é‡æå‡ä¸è¶³ï¼Œå¯èƒ½æ˜¯åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­è¢«æ¶ˆè€—

**å»ºè®®æ”¹è¿›**: ä½¿ç”¨é¥±å’Œè¡°å‡å…¬å¼ï¼ˆç”¨æˆ·æä¾›çš„æ•°å­¦æ¼”ç®—ï¼‰
```
New = Total Ã— (1 + 0.8 Ã— e^(-Total/1000))
```

---

## ğŸ”„ å®Œæ•´è®¡ç®—è·¯å¾„

### Phase 1: èŠ‚ç‚¹åˆå§‹åŒ–

**å…¥å£**: `GraphNetworkEngine.initialize_nodes()`

**æ­¥éª¤**:
1. è§£æå…«å­—ï¼Œåˆ›å»ºèŠ‚ç‚¹ï¼ˆå¤©å¹²+åœ°æ”¯ï¼‰
2. è®¡ç®—åˆå§‹èƒ½é‡ `H0`ï¼ˆåŸºäºæœˆä»¤ã€é€šæ ¹ã€è‡ªåç­‰ï¼‰
3. åº”ç”¨é‡å­çº ç¼ ï¼ˆåˆåŒ–æ£€æµ‹ï¼‰ï¼š`_apply_quantum_entanglement_once()`
   - æ£€æµ‹ä¸‰åˆã€åŠåˆã€æ‹±åˆã€å…­åˆã€å¤©å¹²äº”åˆ
   - åº”ç”¨bonusåˆ°åˆå§‹èƒ½é‡
   - å…ƒç´ è½¬åŒ–ï¼ˆå¦‚ç”³å­è¾°ä¸‰åˆæ°´å±€ â†’ æ‰€æœ‰èŠ‚ç‚¹è½¬ä¸ºæ°´ï¼‰

**å…³é”®ä»£ç ä½ç½®**: `core/engine_graph.py::initialize_nodes()`

---

### Phase 2: èƒ½é‡ä¼ æ’­

**å…¥å£**: `GraphNetworkEngine.propagate(max_iterations=2, damping=0.98)`

**è¿­ä»£æµç¨‹**:

#### 2.1 çŸ©é˜µä¹˜æ³•ï¼ˆåˆå§‹ä¼ æ’­ï¼‰
```python
H_new = adjacency_matrix @ H
```
- ä½¿ç”¨é‚»æ¥çŸ©é˜µè¿›è¡Œèƒ½é‡ä¼ æ’­
- æ­£æƒé‡ï¼šç”Ÿå…³ç³»ã€æ¯”åŠ«å…³ç³»
- è´Ÿæƒé‡ï¼šå…‹å…³ç³»

#### 2.2 ç”Ÿå…³ç³»å¤„ç†ï¼ˆGenerationï¼‰

**ä»£ç ä½ç½®**: `core/engine_graph.py::propagate()` (line 944-972)

**è®¡ç®—è·¯å¾„**:
```python
if is_generation:
    # 1. è·å–æºèŠ‚ç‚¹èƒ½é‡
    source_energy_val = source_prob.mean
    
    # 2. ä½¿ç”¨é˜ˆå€¼ç”Ÿå‘å…¬å¼
    generation_output = FlowEngine.calculate_generation(
        source_energy_val, 
        current_generation_efficiency
    )
    
    # 3. è½¬æ¢ä¸ºProbValueå¹¶åº”ç”¨åˆ°ç›®æ ‡èŠ‚ç‚¹
    gain = ProbValue(generation_output, std_dev_percent=...)
    H_new[i] = H_new[i] + gain * abs(weight) * decay
    
    # 4. è®¡ç®—æºèŠ‚ç‚¹æ³„æ°”é‡
    if generation_output > 0:
        effective_source = source_energy_val - 5.0
        drain_amount = effective_source * abs(weight) * actual_drain_factor * decay
        total_drain += drain_amount
```

**å…³é”®ç‚¹**:
- ä½¿ç”¨ `calculate_generation()` è€Œéæ—§çš„ `apply_logistic_potential()`
- å¼±æºï¼ˆèƒ½é‡<5.0ï¼‰è¾“å‡ºä¸º0ï¼Œæ— æ³„æ°”

#### 2.3 å…‹å…³ç³»å¤„ç†ï¼ˆControlï¼‰

**ä»£ç ä½ç½®**: `core/engine_graph.py::propagate()` (line 1000-1095)

**è®¡ç®—è·¯å¾„**:
```python
if is_control:
    # 1. æ‰¾åˆ°æœ€å¼ºæ”»å‡»è€…
    max_attacker_energy = ...
    max_weight = ...
    
    # 2. åº”ç”¨Sigmoidæ”»é˜²å·®åˆ†å…¬å¼
    damage_wave = self.apply_scattering_interaction(
        max_attacker_energy, 
        target_energy
    )
    
    # 3. åº”ç”¨æ®‹è¡€ä¿æŠ¤ï¼ˆå¯é€‰ï¼Œå¯èƒ½ä¸Sigmoidå†²çªï¼‰
    protection_factor = ...  # æ ¹æ®èƒ½é‡æŸå¤±ç¨‹åº¦è°ƒæ•´
    damage_wave = damage_wave * protection_factor
    
    # 4. æ‰£é™¤ä¼¤å®³
    H_new[i] = target_energy - damage_wave * max_weight
```

**å…³é”®ä»£ç **: `core/engine_graph.py::apply_scattering_interaction()` (line 633-675)

```python
def apply_scattering_interaction(self, attacker, target):
    # è½¬æ¢ä¸ºæ•°å€¼
    attacker_val = attacker.mean
    target_val = target.mean
    
    # è·å–é…ç½®
    flow_config = self.config.get('flow', {})
    base_impact = flow_config.get('controlImpact', 0.8)
    
    # è°ƒç”¨Sigmoidå…¬å¼
    damage_mean = FlowEngine.calculate_control_damage(
        attacker_val, 
        target_val, 
        base_impact
    )
    
    # è®¡ç®—æ–¹å·®è†¨èƒ€
    impact_ratio = damage_mean / (target_val + 1e-5)
    damage_std = target.std * impact_ratio * 1.5
    
    return ProbValue(damage_mean, std_dev_percent=damage_std/damage_mean)
```

#### 2.4 åˆå±€ä¿æŠ¤ï¼ˆCombination Protectionï¼‰

**ä»£ç ä½ç½®**: `core/engine_graph.py::propagate()` (line 1085-1126)

**é€»è¾‘**:
```python
# æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦åœ¨åˆå±€ä¸­
is_in_combo = check_if_in_combination(node_i)

if is_in_combo:
    # å¦‚æœèƒ½é‡ä½äºåˆå§‹èƒ½é‡çš„95%ï¼Œå¼ºåˆ¶æ¢å¤åˆ°95%
    if current_val < h0_val * 0.95:
        source_energy = ProbValue(h0_val * 0.95, ...)
        gain_wave, _ = self.apply_superconductivity(source_energy, combo_type)
        H_new[i] = gain_wave
```

**é—®é¢˜**: ä¿æŠ¤é˜ˆå€¼95%å¯èƒ½è¿‡é«˜ï¼Œå¯¼è‡´F2-F4èƒ½é‡æå‡ä¸è¶³

#### 2.5 å…¨å±€é˜»å°¼ï¼ˆGlobal Dampingï¼‰

**ä»£ç ä½ç½®**: `core/engine_graph.py::propagate()` (line 1337-1350)

```python
entropy_factor = (1.0 - global_entropy)  # entropy = 0.05
H[i] = H[i] * entropy_factor
```

**å½±å“**: æ¯è½®è¿­ä»£æ‰€æœ‰èŠ‚ç‚¹èƒ½é‡è¡°å‡5%

---

## ğŸ“Š æµ‹è¯•ç»“æœåˆ†æ

### å½“å‰é€šè¿‡ç‡: 10.0% (1/10)

#### âœ… é€šè¿‡çš„æ¡ˆä¾‹

**F5_JiaJi_Combine** (å¤©å¹²äº”åˆ)
- èƒ½é‡æ¯”ç‡: 1.133 (é¢„æœŸ: 1.300, è¯¯å·®: 12.9%)
- çŠ¶æ€: âœ… é€šè¿‡ï¼ˆè¯¯å·®<20%ï¼‰
- åˆ†æ: `transformBonus=1.2` ç”Ÿæ•ˆï¼Œèƒ½é‡æå‡åˆç†

#### âŒ å¤±è´¥çš„æ¡ˆä¾‹

**E1_Water_Fire** (å¼ºæ°´å…‹ç«)
- èƒ½é‡æ¯”ç‡: 0.047 (é¢„æœŸ: 0.500, è¯¯å·®: 90.5%)
- **é—®é¢˜**: å¤šè½®è¿­ä»£å¯¼è‡´èƒ½é‡æŒç»­ä¸‹é™
- **æ•°å­¦éªŒè¯**: å•è½®è¿­ä»£åº”å¾—åˆ°0.4152ï¼Œä½†2è½®è¿­ä»£åé™åˆ°0.047

**E2_Weak_Ctrl** (å¼±æ°´å…‹å¼ºç«)
- èƒ½é‡æ¯”ç‡: 0.558 (é¢„æœŸ: 0.900, è¯¯å·®: 38.0%)
- **é—®é¢˜**: è™½ç„¶Sigmoidå…¬å¼è®¡ç®—æ­£ç¡®ï¼ˆå•è½®åº”å¾—1.0ï¼‰ï¼Œä½†å¤šè½®è¿­ä»£ä»æœ‰æŸå¤±
- **å¯èƒ½åŸå› **: å…¨å±€é˜»å°¼ã€æ®‹è¡€ä¿æŠ¤æœºåˆ¶å¹²æ‰°

**D2_Weak_Gen** (å¼±æœ¨ç”Ÿç«)
- èƒ½é‡æ¯”ç‡: 1.504 (é¢„æœŸ: 1.100, è¯¯å·®: 36.7%)
- **é—®é¢˜**: é˜ˆå€¼ç”Ÿå‘å…¬å¼ç”Ÿæ•ˆï¼ˆè¾“å‡º=0ï¼‰ï¼Œä½†èƒ½é‡æ¯”ç‡ä»>1.0
- **å¯èƒ½åŸå› **: å…¶ä»–èƒ½é‡æºï¼ˆå¦‚æ¯”åŠ«å…³ç³»ï¼‰ä»åœ¨ç”Ÿç«

**F1-F4** (åˆåŒ–æ¡ˆä¾‹)
- **å…±åŒé—®é¢˜**: èƒ½é‡æå‡ä¸è¶³ï¼Œbonusæœªå®Œå…¨ç”Ÿæ•ˆ
- **F1**: 1.252 vs é¢„æœŸ2.0ï¼ˆä¸‰åˆå±€ï¼‰
- **F2**: 0.941 vs é¢„æœŸ1.3ï¼ˆå…­åˆï¼‰
- **F3**: 1.035 vs é¢„æœŸ1.4ï¼ˆåŠåˆï¼‰
- **F4**: 0.734 vs é¢„æœŸ1.1ï¼ˆæ‹±åˆï¼‰
- **å¯èƒ½åŸå› **: 
  1. ä¼ æ’­è¿‡ç¨‹ä¸­èƒ½é‡è¢«æ¶ˆè€—ï¼ˆå…¨å±€é˜»å°¼ã€è·ç¦»è¡°å‡ï¼‰
  2. åˆå±€ä¿æŠ¤é˜ˆå€¼è¿‡é«˜ï¼ˆ95%ï¼‰
  3. Bonusåº”ç”¨æ—¶æœºé—®é¢˜ï¼ˆåœ¨ä¼ æ’­å‰åº”ç”¨ï¼Œä½†ä¼ æ’­è¿‡ç¨‹ä¸­è¢«æ¶ˆè€—ï¼‰

---

## ğŸ” é—®é¢˜è¯Šæ–­

### é—®é¢˜1: å¤šè½®è¿­ä»£å¯¼è‡´èƒ½é‡è¿‡åº¦æ¶ˆè€—

**ç°è±¡**: 
- E1æ¡ˆä¾‹ï¼šå•è½®è¿­ä»£åº”å¾—0.4152ï¼Œ2è½®è¿­ä»£åé™åˆ°0.047
- E2æ¡ˆä¾‹ï¼šå•è½®è¿­ä»£åº”å¾—1.0ï¼Œ2è½®è¿­ä»£åé™åˆ°0.558

**æ ¹æœ¬åŸå› **:
1. æ¯è½®è¿­ä»£éƒ½åº”ç”¨å…‹åˆ¶ä¼¤å®³
2. å…¨å±€é˜»å°¼æ¯è½®è¡°å‡5%
3. æ®‹è¡€ä¿æŠ¤æœºåˆ¶å¯èƒ½ä¸å¤Ÿæœ‰æ•ˆ

**è§£å†³æ–¹æ¡ˆ**:
- å‡å°‘è¿­ä»£æ¬¡æ•°ï¼ˆå½“å‰2è½®ï¼Œå»ºè®®1è½®ï¼‰
- æé«˜é˜»å°¼ç³»æ•°ï¼ˆå½“å‰0.98ï¼Œå»ºè®®0.99ï¼‰
- ç§»é™¤æˆ–è°ƒæ•´æ®‹è¡€ä¿æŠ¤ï¼ˆSigmoidå·²å¤„ç†å¼ºå¼±å…³ç³»ï¼‰

### é—®é¢˜2: åˆåŒ–èƒ½é‡æå‡ä¸è¶³

**ç°è±¡**: F1-F4æ¡ˆä¾‹çš„bonusæœªå®Œå…¨ç”Ÿæ•ˆ

**æ ¹æœ¬åŸå› **:
1. Bonusåœ¨åˆå§‹åŒ–æ—¶åº”ç”¨ï¼Œä½†ä¼ æ’­è¿‡ç¨‹ä¸­è¢«æ¶ˆè€—
2. åˆå±€ä¿æŠ¤é˜ˆå€¼95%è¿‡é«˜ï¼Œå¯¼è‡´èƒ½é‡æ— æ³•æå‡
3. å…¨å±€é˜»å°¼å’Œè·ç¦»è¡°å‡æ¶ˆè€—èƒ½é‡

**è§£å†³æ–¹æ¡ˆ**:
- é™ä½åˆå±€ä¿æŠ¤é˜ˆå€¼ï¼ˆä»95%åˆ°90%æˆ–æ›´ä½ï¼‰
- åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­æŒç»­ä¿æŠ¤åˆå±€èƒ½é‡
- è€ƒè™‘åœ¨ä¼ æ’­åå†æ¬¡åº”ç”¨bonus

### é—®é¢˜3: å¼±æœ¨ç”Ÿç«ä»æœ‰è¾“å‡º

**ç°è±¡**: D2æ¡ˆä¾‹èƒ½é‡æ¯”ç‡1.504 > é¢„æœŸ1.1

**æ ¹æœ¬åŸå› **:
- é˜ˆå€¼ç”Ÿå‘å…¬å¼ç”Ÿæ•ˆï¼ˆè¾“å‡º=0ï¼‰
- ä½†å…¶ä»–èƒ½é‡æºï¼ˆå¦‚æ¯”åŠ«å…³ç³»ã€å…¶ä»–ç”Ÿå…³ç³»ï¼‰ä»åœ¨ç”Ÿç«

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ‰€æœ‰ç”Ÿå…³ç³»è·¯å¾„
- ç¡®ä¿å¼±æºåœ¨æ‰€æœ‰è·¯å¾„ä¸Šéƒ½æ— æ³•ç”Ÿå‘

---

## ğŸ› ï¸ è°ƒä¼˜å»ºè®®

### çŸ­æœŸä¼˜åŒ–ï¼ˆç«‹å³å®æ–½ï¼‰

1. **è°ƒæ•´è¿­ä»£å‚æ•°**
   ```python
   # å½“å‰: max_iterations=2, damping=0.98
   # å»ºè®®: max_iterations=1, damping=0.99
   H_final = self.engine.propagate(max_iterations=1, damping=0.99)
   ```

2. **ç§»é™¤æ®‹è¡€ä¿æŠ¤æœºåˆ¶**
   - Sigmoidå…¬å¼å·²å¤„ç†å¼ºå¼±å…³ç³»
   - æ®‹è¡€ä¿æŠ¤å¯èƒ½å¹²æ‰°Sigmoidçš„æ•ˆæœ
   - å»ºè®®ç§»é™¤æˆ–å¤§å¹…ç®€åŒ–

3. **é™ä½åˆå±€ä¿æŠ¤é˜ˆå€¼**
   ```python
   # å½“å‰: if current_val < h0_val * 0.95
   # å»ºè®®: if current_val < h0_val * 0.90
   ```

### ä¸­æœŸä¼˜åŒ–ï¼ˆéœ€è¦æµ‹è¯•ï¼‰

1. **å®ç°é¥±å’Œè¡°å‡å…¬å¼**ï¼ˆç”¨æˆ·æä¾›çš„æ•°å­¦æ¼”ç®—ï¼‰
   ```python
   # åˆåŒ–èƒ½é‡ä½¿ç”¨æŒ‡æ•°è¡°å‡
   new_energy = total_energy * (1 + 0.8 * math.exp(-total_energy / 1000))
   ```

2. **ä¼˜åŒ–åˆå±€ä¿æŠ¤é€»è¾‘**
   - åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­æŒç»­ä¿æŠ¤
   - åŒºåˆ†ä¸åŒç±»å‹çš„åˆå±€ï¼ˆä¸‰åˆã€åŠåˆã€æ‹±åˆï¼‰

3. **æ£€æŸ¥æ‰€æœ‰ç”Ÿå…³ç³»è·¯å¾„**
   - ç¡®ä¿å¼±æºåœ¨æ‰€æœ‰è·¯å¾„ä¸Šéƒ½åº”ç”¨é˜ˆå€¼ç”Ÿå‘

### é•¿æœŸä¼˜åŒ–ï¼ˆæ¶æ„æ”¹è¿›ï¼‰

1. **åˆ†ç¦»åˆå§‹åŒ–bonuså’Œä¼ æ’­bonus**
   - åˆå§‹åŒ–æ—¶åº”ç”¨åŸºç¡€bonus
   - ä¼ æ’­è¿‡ç¨‹ä¸­åº”ç”¨æŒç»­å¢ç›Š

2. **å¼•å…¥èƒ½é‡å®ˆæ’æ£€æŸ¥**
   - ç¡®ä¿èƒ½é‡å˜åŒ–ç¬¦åˆç‰©ç†å®šå¾‹
   - é˜²æ­¢èƒ½é‡å‡­ç©ºäº§ç”Ÿæˆ–æ¶ˆå¤±

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒå®ç°æ–‡ä»¶

1. **`core/engines/flow_engine.py`**
   - `calculate_control_damage()`: Sigmoidæ”»é˜²å·®åˆ†
   - `calculate_generation()`: é˜ˆå€¼ç”Ÿå‘

2. **`core/engine_graph.py`**
   - `apply_scattering_interaction()`: è°ƒç”¨Sigmoidå…¬å¼
   - `propagate()`: ä¸»ä¼ æ’­å¾ªç¯
   - `_apply_quantum_entanglement_once()`: åˆåŒ–æ£€æµ‹å’Œåº”ç”¨

3. **`core/engine_graph/phase3_propagation.py`**
   - é‡æ„ç‰ˆæœ¬çš„ä¼ æ’­é€»è¾‘ï¼ˆéœ€è¦åŒæ­¥æ›´æ–°ï¼‰

4. **`config/parameters.json`**
   - `controlImpact: 0.8`
   - åˆåŒ–bonuså‚æ•°

### æµ‹è¯•æ–‡ä»¶

1. **`scripts/auto_verify_phase2.py`**: è‡ªåŠ¨éªŒè¯è„šæœ¬
2. **`core/phase2_verifier.py`**: éªŒè¯å™¨å®ç°
3. **`data/phase2_test_cases.json`**: æµ‹è¯•æ¡ˆä¾‹
4. **`data/phase2_verification_results.json`**: æµ‹è¯•ç»“æœ

---

## ğŸ§ª æ•°å­¦éªŒè¯ç»“æœ

### å•è½®è¿­ä»£éªŒè¯ï¼ˆå…¬å¼å±‚é¢ï¼‰

| æ¡ˆä¾‹ | è¾“å…¥ | å…¬å¼è®¡ç®— | é¢„æœŸ | çŠ¶æ€ |
|------|------|---------|------|------|
| E1 | Atk=50, Def=40 | ä¼¤å®³=23.39, æ¯”ç‡=0.4152 | 0.4-0.5 | âœ… |
| E2 | Atk=2, Def=100 | ä¼¤å®³=0.0044, æ¯”ç‡=1.0000 | >0.9 | âœ… |
| D2 | Mother=3.3 | è¾“å‡º=0.0 | 0.0 | âœ… |

### å¤šè½®è¿­ä»£éªŒè¯ï¼ˆå®é™…æµ‹è¯•ï¼‰

| æ¡ˆä¾‹ | 1è½® | 2è½® | 3è½® | å®é™…ç»“æœ | é—®é¢˜ |
|------|-----|-----|-----|----------|------|
| E1 | 0.4152 | 0.0944 | 0.0196 | 0.047 | è¿‡åº¦æ¶ˆè€— |
| E2 | 1.0000 | 0.9996 | 0.9992 | 0.558 | å…¶ä»–å› ç´ å¹²æ‰° |

---

## ğŸ“ ä»£ç å˜æ›´è®°å½•

### V9.4 ä¸»è¦å˜æ›´

1. **`core/engines/flow_engine.py`**
   - é‡å†™ `calculate_control_damage()`: ä½¿ç”¨Sigmoidå…¬å¼
   - æ–°å¢ `calculate_generation()`: é˜ˆå€¼ç”Ÿå‘

2. **`core/engine_graph.py`**
   - æ›´æ–° `apply_scattering_interaction()`: è°ƒç”¨æ–°å…¬å¼
   - æ›´æ–°ç”Ÿå…³ç³»å¤„ç†: ä½¿ç”¨ `calculate_generation()`
   - æ³¨é‡Šæ›´æ–°: ç§»é™¤æ—§çš„å¼±æœ¨ç”Ÿç«ä¼˜åŒ–ä»£ç 

3. **`config/parameters.json`**
   - `controlImpact`: 0.15 â†’ 0.8
   - åˆåŒ–bonuså‚æ•°è°ƒæ•´

4. **`core/phase2_verifier.py`**
   - è¿­ä»£æ¬¡æ•°: 3 â†’ 1ï¼ˆæµ‹è¯•ä¸­ï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ä¼˜å…ˆçº§1ï¼ˆç«‹å³æ‰§è¡Œï¼‰

1. âœ… å‡å°‘è¿­ä»£æ¬¡æ•°åˆ°1è½®
2. âœ… æé«˜é˜»å°¼ç³»æ•°åˆ°0.99
3. âœ… ç§»é™¤æˆ–ç®€åŒ–æ®‹è¡€ä¿æŠ¤æœºåˆ¶

### ä¼˜å…ˆçº§2ï¼ˆæœ¬å‘¨å†…ï¼‰

1. â³ å®ç°é¥±å’Œè¡°å‡å…¬å¼ï¼ˆåˆåŒ–èƒ½é‡ï¼‰
2. â³ ä¼˜åŒ–åˆå±€ä¿æŠ¤é€»è¾‘
3. â³ æ£€æŸ¥æ‰€æœ‰ç”Ÿå…³ç³»è·¯å¾„

### ä¼˜å…ˆçº§3ï¼ˆé•¿æœŸï¼‰

1. â³ æ¶æ„é‡æ„ï¼šåˆ†ç¦»åˆå§‹åŒ–å’Œä¼ æ’­bonus
2. â³ å¼•å…¥èƒ½é‡å®ˆæ’æ£€æŸ¥
3. â³ æ€§èƒ½ä¼˜åŒ–

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

1. **ç®—æ³•æ€»çº²**: `docs/ALGORITHM_CONSTITUTION_v2.6.md`
2. **åˆåŒ–æ–‡æ¡£**: `docs/ALGORITHM_V6.1_CLASH_COMBINATION.md`
3. **V9.4é…ç½®**: `config/presets/physics_v9_4.json`ï¼ˆç”¨æˆ·æä¾›ï¼‰

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- ä»£ç ä»“åº“: `/home/jin/bazi_predict`
- æµ‹è¯•è„šæœ¬: `scripts/auto_verify_phase2.py`
- æµ‹è¯•ç»“æœ: `data/phase2_verification_results.json`

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-12-19 22:10:00  
**æŠ¥å‘Šç‰ˆæœ¬**: 1.0  
**ç»´æŠ¤è€…**: Bazi Predict Team

