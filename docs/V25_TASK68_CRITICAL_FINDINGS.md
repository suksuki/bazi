# V25.0 任务 68：关键对齐问题发现报告

## 🚨 严重问题：复杂交互导致能量过度衰减

### 诊断结果

**C07 八字：** 辛丑、乙未、庚午、甲申

**能量变化：**
- Earth: 29.7 → 4.64 (下降 **84.4%**)
- Wood: 42.6 → 17.04 (下降 **60.0%**)

### 问题根源分析

#### 1. 未-丑相冲（六冲）

**理论预期（减法惩罚）：**
- Earth 能量：29.7 - 3.0 = **26.7**

**实际结果：**
- Earth 能量：**4.64**

**差值：** 26.7 - 4.64 = **22.06**

#### 2. 可能的多重交互叠加

**C07 的交互检测：**
1. **未-丑相冲：** 月支未与年支丑相冲 → Earth 能量 -3.0
2. **午-未相合：** 日支午与月支未相合（六合） → 可能影响 Earth 或 Fire 能量
3. **可能的天干五合（合绊）：** 如果触发了合绊，会使用乘法惩罚（0.4倍）

**关键发现：**
- 代码中，**六合使用乘法：** `energy[transform_to] = base_energy * 1.2` (第368行)
- 如果午-未相合触发了六合，Earth 能量会被乘法修正
- 但六合是**正向修正**（乘法1.2），不应该导致能量下降

#### 3. 天干五合（合绊）的乘法惩罚

**代码位置：** 第306-307行
```python
energy[e1] *= penalty  # penalty = 0.4
energy[e2] *= penalty
```

**如果触发了合绊：**
- 能量会被乘以 0.4（下降60%）
- 这可能导致能量大幅下降

**C07 的天干检查：**
- 年干辛、月干乙、日干庚、时干甲
- 需要检查是否有天干五合

---

## 🔍 问题 2：S0_Base = 0.00（已修复）

### 修复内容

**位置：** `core/processors/domains.py` 的 `_calc_career` 方法

**修复：**
- 在返回字典中添加 `s0_base` 和 `base_score` 键
- 确保 `s0_base` 在返回前被正确设置

---

## 🔍 问题 3：Pillar Weights 未正确应用

### 诊断

**诊断脚本输出：**
- Pillar Weights: `{'year': 0.8, 'month': 1.2, 'day': 1.0, 'hour': 0.9}`
- **V24.0 预期：** `{'year': 1.0, 'month': 1.8, 'day': 1.5, 'hour': 1.2}`

### 问题根源

**代码检查：**
- `PhysicsProcessor` 的 `PILLAR_WEIGHTS` 默认值是 V24.0 的值
- 但 `process` 方法中会从 `context.get('pillar_weights', {})` 读取配置
- 如果配置为空或未传递，会使用默认值，但默认值可能不是最新的

**修复：**
- 已更新 `PhysicsProcessor` 的默认 `PILLAR_WEIGHTS` 为 V24.0 值
- 已更新 `process` 方法中的默认值（month: 1.5 → 1.8）

---

## 🔍 问题 4：Particle Weights 未应用

### 诊断

**诊断脚本输出：**
- Particle Weights: 全部为 1.0
- **预期：** 应该从 `config/parameters.json` 的 `particleWeights` 读取

### 问题根源

**代码检查：**
- `EngineV88` 从配置中读取 `particleWeights` 并传递给 `DomainProcessor`
- 但诊断脚本可能没有正确传递配置

**修复：**
- 已添加 `particle_weights` 的默认值处理，确保不为空

---

## 💡 关键修复：检查复杂交互的执行顺序

### 问题

**C07 的能量下降可能由以下原因导致：**

1. **天干五合（合绊）的乘法惩罚：**
   - 如果触发了合绊，能量会被乘以 0.4
   - 这可能导致能量大幅下降

2. **交互执行顺序：**
   - 如果先执行了乘法修正（合绊），再执行减法惩罚（相冲），能量会被多次修正
   - 这可能导致能量过度衰减

### 修复方案

**需要检查：**
1. C07 是否触发了天干五合（合绊）？
2. 交互的执行顺序是否正确？
3. 是否有多个交互同时作用导致能量被多次修正？

---

## 📝 下一步行动

### 选项 A：详细检查 C07 的交互

1. 检查 C07 是否触发了天干五合（合绊）
2. 检查交互的执行顺序
3. 检查是否有多个交互同时作用
4. 修复交互逻辑，避免能量过度衰减

### 选项 B：添加交互优先级

1. 定义交互优先级（例如：相冲 > 相合 > 相刑 > 相害）
2. 确保同一元素不会被多个交互同时修正
3. 重新运行批量校准验证

---

**报告生成时间：** V25.0 Task 68 (Critical Findings)
**验证状态：** ❌ 发现复杂交互导致能量过度衰减，需要详细检查

