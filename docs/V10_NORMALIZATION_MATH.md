# V10.0 参数归一化数学推演

## 📊 当前参数状态

| 参数 | 当前值 | 目标值 | 变化比例 |
|------|--------|--------|----------|
| 通根系数 (Rooting) | 2.16 | 1.0 | -53.7% |
| 透干加成 (Exposed) | 2.30 | 1.5 | -34.8% |
| 自坐强根 (Sitting) | 3.00 | 1.5 | -50.0% |

## 🔢 数学推演

### 1. 通根系数 (Rooting Weight)

**当前公式**:
```
E_root = E_base × rootingWeight × Tanh(rooting_strength / saturation)
```

**示例：甲木有根（根强度=1.0）**

*旧值 (2.16)*:
```
E_base = 10.0 (假设基础能量)
E_root = 10.0 × 2.16 × Tanh(1.0 / 2.5)
       = 10.0 × 2.16 × 0.38
       = 8.21
```

*新值 (1.0)*:
```
E_root = 10.0 × 1.0 × Tanh(1.0 / 2.5)
       = 10.0 × 1.0 × 0.38
       = 3.8
```

**结论**: 新值降低53.7%，避免后续Sigmoid饱和。如果多个节点都有根，旧值会导致总能量超过100。

---

### 2. 透干加成 (Exposed Boost)

**当前公式**:
```
E_exposed = E_base × (1 + exposedBoost × exposure_strength)
```

**示例：甲木透干（透干强度=1.0）**

*旧值 (2.30)*:
```
E_base = 10.0
E_exposed = 10.0 × (1 + 2.30 × 1.0)
          = 10.0 × 3.30
          = 33.0
```

*新值 (1.5)*:
```
E_exposed = 10.0 × (1 + 1.5 × 1.0)
          = 10.0 × 2.5
          = 25.0
```

**结论**: 新值降低34.8%，但仍保持透干的优势（2.5x vs 基础1.0x）。

---

### 3. 自坐强根 (Same Pillar Bonus)

**当前公式**:
```
E_sitting = E_base × samePillarBonus
```

**示例：甲木自坐强根**

*旧值 (3.00)*:
```
E_base = 10.0
E_sitting = 10.0 × 3.00
          = 30.0
```

*新值 (1.5)*:
```
E_sitting = 10.0 × 1.5
          = 15.0
```

**结论**: 新值降低50%，但仍保持自坐的优势（1.5x vs 基础1.0x）。

---

## ⚠️ 能量守恒验证

### 极端情况：甲木同时有根、透干、自坐

**旧值组合**:
```
E_total = E_base × rootingWeight × exposedBoost × samePillarBonus
        = 10.0 × 2.16 × 3.30 × 3.00
        = 213.84 ❌ (超过100，异常！)
```

**新值组合**:
```
E_total = E_base × rootingWeight × exposedBoost × samePillarBonus
        = 10.0 × 1.0 × 2.5 × 1.5
        = 37.5 ✅ (在合理范围内)
```

**结论**: 归一化后，即使极端情况也不会超过100，符合能量守恒。

---

## 📈 Sigmoid 饱和分析

Sigmoid函数: `S(x) = 1 / (1 + e^(-k(x - threshold)))`

当 `x > threshold + 3/k` 时，Sigmoid接近饱和（>95%）。

假设 `k=20`, `threshold=10`:
- 饱和点: `10 + 3/20 = 10.15`
- 如果输入能量 > 10.15，Sigmoid输出接近1.0（饱和）

**旧值风险**:
- 如果基础能量=10，经过2.16×3.30×3.00 = 21.38倍放大
- 最终能量 = 10 × 21.38 = 213.8
- 213.8 >> 10.15，Sigmoid完全饱和，失去非线性特性 ❌

**新值安全**:
- 如果基础能量=10，经过1.0×2.5×1.5 = 3.75倍放大
- 最终能量 = 10 × 3.75 = 37.5
- 37.5 > 10.15，但仍在可调范围内，Sigmoid仍有响应 ✅

---

## ✅ 归一化目标

1. **能量守恒**: 确保总能量不超过100
2. **保持相对优势**: 有根/透干/自坐仍比无根有优势
3. **Sigmoid响应**: 避免完全饱和，保持非线性特性
4. **物理直觉**: 符合"能量不能无限放大"的物理原理

