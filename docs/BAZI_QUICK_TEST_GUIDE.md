# 八字快速测试功能使用指南

## 🎯 功能说明

新增的 **"⚡ 八字测试 (Quick Test)"** 标签页允许您直接输入四柱八字，无需知道精确的出生日期和时间。系统会自动反向计算近似日期并进行排盘。

---

## 📍 使用步骤

### 1. 打开应用
```bash
cd /home/jin/bazi_predict
streamlit run main.py
```

### 2. 导航到八字测试
- 左侧边栏 → **"📂 档案管理 (Archives)"** 展开
- 点击 **"⚡ 八字测试 (Quick Test)"** 标签页

### 3. 输入四柱八字

界面提供4个输入框：

```
┌─────┬─────┬─────┬─────┐
│年柱 │月柱 │日柱 │时柱 │
├─────┼─────┼─────┼─────┤
│甲子 │乙丑 │丙寅 │丁卯 │
└─────┴─────┴─────┴─────┘
```

**输入要求**：
- 每柱**2个汉字**（天干+地支）
- 天干: 甲乙丙丁戊己庚辛壬癸
- 地支: 子丑寅卯辰巳午未申酉戌亥

### 4. 选择性别
- 单选按钮：男/女

### 5. 点击 "🚀 快速排盘"
- 系统会自动计算近似日期
- 触发完整的智能排盘流程

---

## 🏆 V3.0 财库测试案例

### 案例1: 水日主 + 戌财库 (保证看到金杯🏆)

**输入**:
```
年柱: 乙未
月柱: 丙戌
日柱: 壬戌  ← 水日主坐戌(火库/财库)
时柱: 辛亥
性别: 男
```

**操作**:
1. 输入上述四柱
2. 点击 "快速排盘"
3. 在主界面找到 "模拟流年 (Year)" 输入框
4. 输入 **2024** (甲辰年)
5. 滚动到 "🌊 动态流年模拟" 图表

**预期效果**:
- 2024年上方显示 **🏆 金色奖杯**
- 图表下方显示 "🔓 墓库开启事件"
- 财富线在2024年显著上升

---

### 案例2: 乔布斯八字 (测试截脚结构)

**输入**:
```
年柱: 乙未
月柱: 戊寅
日柱: 壬午
时柱: 辛亥
```

**流年测试**: 2011年 (辛卯) - 应显示严重的负分和"截脚"警告

---

### 案例3: 金日主 + 未木库

**输入**:
```
年柱: 庚申
月柱: 丁酉
日柱: 辛未  ← 金日主坐未(木库/财库)
时柱: 戊子
```

**流年测试**: 2021年 (辛丑) - 丑未冲，触发财库开启

---

## 🔍 工作原理

### 反向日期计算逻辑

系统使用简化的算法：

1. **年份推算**:
   - 基于1924-2043的60甲子周期
   - 匹配天干地支组合

2. **月份推算**:
   - 根据月支推算季节
   - 寅(2月) 卯(3月) 辰(4月)... 子(12月) 丑(1月)

3. **时辰推算**:
   - 子(0时) 丑(2时) 寅(4时)...
   - 转换为24小时制

### 示例

输入：`乙未 丙戌 壬戌 辛亥`

计算结果：
- 年份: 1955年 (乙未年在1924+31=1955)
- 月份: 10月 (戌月)
- 日期: 15日 (每月中旬作为默认)
- 时间: 22:00 (亥时)

→ 近似日期: **1955-10-15 22:00**

---

## ⚠️ 注意事项

1. **日期仅为近似值**
   - 反向计算无法100%精确
   - 仅用于命理结构分析和测试

2. **日柱最关键**
   - 日主(日干)是核心分析对象
   - 其他柱的精确度影响相对较小

3. **流年仍需手动调整**
   - 输入八字后，需在时空控制台手动设置流年
   - 用于观察不同年份的运势变化

---

## 📖 快速参考

### 常用测试组合

| 日主 | 财库 | 冲年 | 说明 |
|-----|-----|-----|-----|
| 壬(水) | 戌(火) | 辰年(2024) | 水克火，戌为财库 |
| 甲(木) | 辰戌丑未(土) | 相冲年 | 木克土，四土皆为财 |
| 庚(金) | 未(木) | 丑年(2021) | 金克木，未为财库 |
| 丙(火) | 丑(金) | 未年(2027) | 火克金，丑为财库 |
| 戊(土) | 辰(水) | 戌年(2018) | 土克水，辰为财库 |

---

## 🚀 后续增强

未来版本可能添加：
- **智能八字推荐**: 根据当前年份推荐测试八字
- **批量测试模式**: 一次输入多个八字对比
- **案例库**: 预置经典八字（历史名人、典型格局）
- **格局自动识别**: 从格、专旺、化气等特殊格局提示

---

**立即尝试！输入您的测试八字，观察 Antigravity V3.0 的财库特效吧！** 🏆✨
