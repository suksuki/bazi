# FDS-KMS Phase 2: å¢å¼ºä¸è®°å¿† - å®ŒæˆæŠ¥å‘Š

**æ—¥æœŸ**: 2026-01-03  
**çŠ¶æ€**: âœ… **Phase 2 å·²å®Œæˆ**

---

## ğŸ¯ Phase 2 ç›®æ ‡

è¡¥å…¨æœ€åä¸€å—æ‹¼å›¾ï¼šå‘é‡ç´¢å¼•å’Œæ‰¹é‡å¤„ç†èƒ½åŠ›

---

## âœ… å·²å®Œæˆä»»åŠ¡

### ä»»åŠ¡A: æ¿€æ´»å‘é‡è®°å¿† âœ…

**æ–‡ä»¶**: `kms/scripts/vector_indexer_setup.py`

**åŠŸèƒ½**:
- âœ… ChromaDBé›†æˆ
- âœ… BGE-M3 Embeddingæ¨¡å‹æ”¯æŒ
- âœ… è‡ªå®šä¹‰åµŒå…¥å‡½æ•°
- âœ… ç´¢å¼•codexæ¡ç›®
- âœ… ç›¸ä¼¼åº¦æœç´¢
- âœ… æµ‹è¯•åŠŸèƒ½å®Œæ•´

**ä½¿ç”¨**:
```bash
python kms/scripts/vector_indexer_setup.py
```

### ä»»åŠ¡B: å¼ºåŒ–é€»è¾‘å¤§è„‘ âœ…

**æ–‡ä»¶**: `kms/core/semantic_distiller_v2.py`

**æ”¹è¿›**:
- âœ… æ·»åŠ Few-Shotç¤ºä¾‹
- âœ… æ˜ç¡®çš„JSONLogicæ ¼å¼è¦æ±‚
- âœ… ä¸‰ä¸ªå®Œæ•´ç¤ºä¾‹ï¼ˆforming/breaking/savingï¼‰
- âœ… æ ¼å¼éªŒè¯å¢å¼º

**ä¼˜åŠ¿**:
- æé«˜LLMè¾“å‡ºè´¨é‡
- å‡å°‘æ ¼å¼é”™è¯¯
- æ˜ç¡®çš„JSONLogicç»“æ„ç¤ºä¾‹

### ä»»åŠ¡C: æ‰¹é‡å¤„ç† âœ…

**æ–‡ä»¶**: `kms/scripts/batch_processor.py`

**æµæ°´çº¿**:
1. âœ… Read: è¯»å–åŸå§‹æ–‡æœ¬
2. âœ… Split: è‡ªåŠ¨åˆ‡åˆ†æ®µè½
3. âœ… Distill: LLMè¯­ä¹‰è’¸é¦
4. âœ… Index: å‘é‡ç´¢å¼•ï¼ˆå¯é€‰ï¼‰
5. âœ… Save: ä¿å­˜åˆ°JSONL

**åŠŸèƒ½**:
- âœ… å‘½ä»¤è¡Œæ¥å£
- âœ… æ‰¹é‡å¤„ç†æ”¯æŒ
- âœ… è¿›åº¦æ˜¾ç¤º
- âœ… é”™è¯¯å¤„ç†
- âœ… ç»Ÿè®¡æŠ¥å‘Š

**ä½¿ç”¨**:
```bash
python kms/scripts/batch_processor.py raw_texts/å­å¹³çœŸè¯ _è®ºé£Ÿç¥.txt --book å­å¹³çœŸè¯  --topic é£Ÿç¥æ ¼ --index
```

---

## ğŸ“Š ç³»ç»Ÿå®Œæ•´æ€§

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | çŠ¶æ€ | è¯´æ˜ |
| :--- | :--- | :--- |
| è¯­ä¹‰è’¸é¦å™¨ | âœ… V2å®Œæˆ | åŒ…å«Few-Shotç¤ºä¾‹ |
| å‘é‡ç´¢å¼•å™¨ | âœ… å®Œæˆ | ChromaDB + BGE-M3 |
| èšåˆå™¨ | âœ… å®Œæˆ | RC2ç®—æ³•å®ç° |
| æ‰¹é‡å¤„ç†å™¨ | âœ… å®Œæˆ | å®Œæ•´æµæ°´çº¿ |

### å·¥å…·è„šæœ¬

| è„šæœ¬ | çŠ¶æ€ | åŠŸèƒ½ |
| :--- | :--- | :--- |
| quick_start.py | âœ… | å¿«é€Ÿæ¼”ç¤º |
| generate_manifest_example.py | âœ… | Manifestç”Ÿæˆ |
| llm_distill_example.py | âœ… | LLMè’¸é¦æµ‹è¯• |
| sop_dry_run.py | âœ… | SOPæ¨¡æ‹Ÿ |
| vector_indexer_setup.py | âœ… | å‘é‡ç´¢å¼•è®¾ç½® |
| batch_processor.py | âœ… | æ‰¹é‡å¤„ç† |

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯ä»¥åšçš„

1. **æµ‹è¯•å‘é‡ç´¢å¼•å™¨**
   ```bash
   # å®‰è£…ä¾èµ–ï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
   pip install chromadb sentence-transformers
   
   # è¿è¡Œæµ‹è¯•
   python kms/scripts/vector_indexer_setup.py
   ```

2. **æµ‹è¯•æ‰¹é‡å¤„ç†**
   ```bash
   # å‡†å¤‡æµ‹è¯•æ–‡æœ¬æ–‡ä»¶
   echo "é£Ÿç¥æ ¼ï¼Œæœ€å–œè´¢æ˜Ÿé€å¹²ï¼Œèº«æ—ºä¸ºå®œã€‚è‹¥è§æ­å°å¤ºé£Ÿï¼Œåˆ™ç ´æ ¼ã€‚" > kms/data/raw_texts/test.txt
   
   # è¿è¡Œæ‰¹é‡å¤„ç†
   python kms/scripts/batch_processor.py kms/data/raw_texts/test.txt --topic é£Ÿç¥æ ¼
   ```

3. **ä½¿ç”¨V2è’¸é¦å™¨**
   ```python
   from kms.core.semantic_distiller_v2 import SemanticDistillerV2
   distiller = SemanticDistillerV2()
   prompt = distiller.get_system_prompt("å­å¹³çœŸè¯ ", "é£Ÿç¥æ ¼")
   ```

### åç»­è®¡åˆ’

1. **æ•°æ®å‡†å¤‡**
   - æ”¶é›†å®Œæ•´å¤ç±æ–‡æœ¬
   - æ‰¹é‡å¤„ç†ç”Ÿæˆcodex
   - å»ºç«‹å®Œæ•´å‘é‡ç´¢å¼•åº“

2. **è´¨é‡ä¼˜åŒ–**
   - LLMè¾“å‡ºæ ¼å¼å¾®è°ƒ
   - Few-Shotç¤ºä¾‹ä¼˜åŒ–
   - éªŒè¯è§„åˆ™å®Œå–„

3. **é›†æˆæµ‹è¯•**
   - ä¸SOPå·¥ä½œæµé›†æˆ
   - ç«¯åˆ°ç«¯æµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–

---

## ğŸ“ æŠ€æœ¯æ ˆè¡¥å……

### æ–°å¢ä¾èµ–

- `chromadb` - å‘é‡æ•°æ®åº“
- `sentence-transformers` - Embeddingæ¨¡å‹
- `BAAI/bge-m3` - å¤šè¯­è¨€Embeddingæ¨¡å‹ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰

### æ–‡ä»¶ç»“æ„

```
kms/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ semantic_distiller.py      (V1)
â”‚   â”œâ”€â”€ semantic_distiller_v2.py   (V2, æ–°å¢)
â”‚   â”œâ”€â”€ vector_indexer.py          (å·²æœ‰)
â”‚   â””â”€â”€ aggregator.py
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ vector_indexer_setup.py    (æ–°å¢)
â”‚   â””â”€â”€ batch_processor.py         (æ–°å¢)
â””â”€â”€ data/
    â”œâ”€â”€ vector_db/                  (æ–°å¢ï¼ŒChromaDBæ•°æ®åº“)
    â””â”€â”€ classical_codex.jsonl       (æ–°å¢ï¼Œæ‰¹é‡å¤„ç†è¾“å‡º)
```

---

## ğŸŠ æ€»ç»“

**Phase 2 å·²å®Œæˆï¼**

- âœ… å‘é‡è®°å¿†å·²æ¿€æ´»
- âœ… é€»è¾‘å¤§è„‘å·²å¼ºåŒ–
- âœ… æ‰¹é‡å¤„ç†å·²å®ç°

**FDS-KMSç³»ç»Ÿç°åœ¨å…·å¤‡å®Œæ•´çš„ç”Ÿäº§èƒ½åŠ›ï¼**

---

**å®Œæˆæ—¥æœŸ**: 2026-01-03  
**çŠ¶æ€**: âœ… **Phase 2 æˆåŠŸ**

